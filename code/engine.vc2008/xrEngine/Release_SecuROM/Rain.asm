; Listing generated by Microsoft (R) Optimizing Compiler Version 14.00.50727.762 

	TITLE	D:\CLEARSKY\sources\engine\xrEngine\Rain.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

PUBLIC	?destroy@ref_sound@@QAEXXZ			; ref_sound::destroy
PUBLIC	_tanf
PUBLIC	?random_dir@?$_vector3@M@@QAEAAU1@ABU1@MAAVCRandom@@@Z ; _vector3<float>::random_dir
PUBLIC	?mad@?$_vector3@M@@QAEAAU1@ABU1@0M@Z		; _vector3<float>::mad
PUBLIC	??0?$FactoryPtr@VIRainRender@@@@QAE@XZ		; FactoryPtr<IRainRender>::FactoryPtr<IRainRender>
PUBLIC	??0?$xalloc@UItem@CEffect_Rain@@@@QAE@XZ	; xalloc<CEffect_Rain::Item>::xalloc<CEffect_Rain::Item>
PUBLIC	??0?$_Vector_base@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z ; stlp_std::priv::_Vector_base<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::_Vector_base<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >
PUBLIC	??0?$_Impl_vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::_Impl_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >
PUBLIC	??0?$vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z ; stlp_std::vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >
PUBLIC	??0?$xr_vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@@QAE@XZ ; xr_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::xr_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >
PUBLIC	??0?$xalloc@UParticle@CEffect_Rain@@@@QAE@XZ	; xalloc<CEffect_Rain::Particle>::xalloc<CEffect_Rain::Particle>
PUBLIC	??0?$_Vector_base@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z ; stlp_std::priv::_Vector_base<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_Vector_base<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >
PUBLIC	??0?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >
PUBLIC	??0?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >
PUBLIC	??0?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAE@XZ ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >
PUBLIC	?translate_over@?$_matrix@M@@QAEAAU1@ABU?$_vector3@M@@@Z ; _matrix<float>::translate_over
PUBLIC	?rotateY@?$_matrix@M@@QAEAAU1@M@Z		; _matrix<float>::rotateY
PUBLIC	?play@ref_sound@@QAEXPAVCObject@@IM@Z		; ref_sound::play
PUBLIC	?stop@ref_sound@@QAEXXZ				; ref_sound::stop
PUBLIC	?set_position@ref_sound@@QAEXABU?$_vector3@M@@@Z ; ref_sound::set_position
PUBLIC	??$_max@M@@YAMMM@Z				; _max<float>
PUBLIC	?front@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEAAUParticle@CEffect_Rain@@XZ ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::front
PUBLIC	?to_value_type_ref@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAAAUParticle@CEffect_Rain@@AAU45@@Z ; stlp_std::priv::_CastTraits<CEffect_Rain::Particle,CEffect_Rain::Particle>::to_value_type_ref
PUBLIC	?front@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEAAUParticle@CEffect_Rain@@XZ ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::front
PUBLIC	?_M_set@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@00@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_set
PUBLIC	??$__fill_n@PAUParticle@CEffect_Rain@@IU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@IABU23@@Z ; stlp_std::priv::__fill_n<CEffect_Rain::Particle *,unsigned int,CEffect_Rain::Particle>
PUBLIC	?_M_insert_overflow@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@ABU45@ABU__true_type@3@I_N@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_insert_overflow
PUBLIC	?_M_is_inside@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@ABE_NABUParticle@CEffect_Rain@@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_is_inside
PUBLIC	??$__ucopy_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z ; stlp_std::priv::__ucopy_ptrs<CEffect_Rain::Particle *,CEffect_Rain::Particle *>
PUBLIC	??$__copy_backward_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z ; stlp_std::priv::__copy_backward_ptrs<CEffect_Rain::Particle *,CEffect_Rain::Particle *>
PUBLIC	??$fill@PAUParticle@CEffect_Rain@@U12@@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU12@@Z ; stlp_std::fill<CEffect_Rain::Particle *,CEffect_Rain::Particle>
PUBLIC	??$_Param_Construct@UParticle@CEffect_Rain@@U12@@stlp_std@@YAXPAUParticle@CEffect_Rain@@ABU12@@Z ; stlp_std::_Param_Construct<CEffect_Rain::Particle,CEffect_Rain::Particle>
PUBLIC	??$__ufill@PAUParticle@CEffect_Rain@@U12@H@priv@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU23@ABUrandom_access_iterator_tag@1@PAH@Z ; stlp_std::priv::__ufill<CEffect_Rain::Particle *,CEffect_Rain::Particle,int>
PUBLIC	??$__uninitialized_fill_n@PAUParticle@CEffect_Rain@@IU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@IABU23@@Z ; stlp_std::priv::__uninitialized_fill_n<CEffect_Rain::Particle *,unsigned int,CEffect_Rain::Particle>
PUBLIC	?_M_fill_insert_aux@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@ABU__false_type@3@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert_aux
PUBLIC	?_M_fill_insert@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert
PUBLIC	?insert@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXPAUParticle@CEffect_Rain@@IABU45@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::insert
PUBLIC	?resize@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::resize
PUBLIC	?to_storage_type_cref@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAABUParticle@CEffect_Rain@@ABU45@@Z ; stlp_std::priv::_CastTraits<CEffect_Rain::Particle,CEffect_Rain::Particle>::to_storage_type_cref
PUBLIC	?resize@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::resize
PUBLIC	?size@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QBEIXZ ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::size
PUBLIC	?size@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QBEIXZ ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::size
PUBLIC	?to_value_type_ptr@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAPAUParticle@CEffect_Rain@@PAU45@@Z ; stlp_std::priv::_CastTraits<CEffect_Rain::Particle,CEffect_Rain::Particle>::to_value_type_ptr
PUBLIC	?begin@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEPAUParticle@CEffect_Rain@@XZ ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::begin
PUBLIC	??A?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEAAUParticle@CEffect_Rain@@I@Z ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::operator[]
PUBLIC	??C?$FactoryPtr@VIRainRender@@@@QBEPAVIRainRender@@XZ ; FactoryPtr<IRainRender>::operator->
PUBLIC	??$__copy_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z ; stlp_std::priv::__copy_ptrs<CEffect_Rain::Particle *,CEffect_Rain::Particle *>
PUBLIC	?_M_erase@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEPAUParticle@CEffect_Rain@@PAU45@0ABU__false_type@3@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_erase
PUBLIC	?erase@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEPAUParticle@CEffect_Rain@@PAU45@0@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::erase
PUBLIC	?clear@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXXZ ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear
PUBLIC	?clear@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEXXZ ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear
PUBLIC	?clear_and_free@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEXXZ ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear_and_free
PUBLIC	?clear@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEXXZ ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear
PUBLIC	??_C@_0N@LMFHAIJK@ambient?2rain?$AA@		; `string'
EXTRN	__imp_?RayPick@CObjectSpace@@QAEHABU?$_vector3@M@@0MW4rq_target@collide@@AAUrq_result@4@PAVCObject@@@Z:PROC
;	COMDAT ?hemi_factor@?3??OnFrame@CEffect_Rain@@QAEXXZ@4MA
_BSS	SEGMENT
?hemi_factor@?3??OnFrame@CEffect_Rain@@QAEXXZ@4MA DD 01H DUP (?) ; `CEffect_Rain::OnFrame'::`4'::hemi_factor
;	COMDAT ??_C@_0N@LMFHAIJK@ambient?2rain?$AA@
CONST	SEGMENT
??_C@_0N@LMFHAIJK@ambient?2rain?$AA@ DB 'ambient\rain', 00H ; `string'
_source_offset DD 042200000r			; 40
_drop_angle DD	040400000r			; 3
_drop_max_wind_vel DD 041a00000r		; 20
_drop_speed_min DD 042200000r			; 40
_drop_speed_max DD 042a00000r			; 80
_particles_time DD 03e99999ar			; 0.3
_EPS_L	DD	03a83126fr			; 0.001
_M_PI	DD	040490fdbr			; 3.14159
_PI	DD	040490fdbr			; 3.14159
_PI_MUL_2 DD	040c90fdbr			; 6.28319
_PI_DIV_2 DD	03fc90fdbr			; 1.5708
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrsound\sound.h
;	COMDAT ?destroy@ref_sound@@QAEXXZ
_TEXT	SEGMENT
_this$ = 8						; size = 4
?destroy@ref_sound@@QAEXXZ PROC				; ref_sound::destroy, COMDAT

; 304  : IC void	ref_sound::destroy						( )														{	VERIFY(!::Sound->i_locked()); 	::Sound->destroy	(*this);													}

	mov	eax, DWORD PTR __imp_?Sound@@3PAVCSound_manager_interface@@A
	mov	ecx, DWORD PTR [eax]
	mov	edx, DWORD PTR [ecx]
	mov	edx, DWORD PTR [edx+40]
	jmp	edx
?destroy@ref_sound@@QAEXXZ ENDP				; ref_sound::destroy
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?play@ref_sound@@QAEXPAVCObject@@IM@Z
_TEXT	SEGMENT
_this$ = 8						; size = 4
?play@ref_sound@@QAEXPAVCObject@@IM@Z PROC		; ref_sound::play, COMDAT

; 305  : IC void	ref_sound::play							( CObject* O,						u32 flags, float d)	{	VERIFY(!::Sound->i_locked()); 	::Sound->play		(*this,O,flags,d);											}

	mov	eax, DWORD PTR __imp_?Sound@@3PAVCSound_manager_interface@@A
	fldz
	mov	ecx, DWORD PTR [eax]
	mov	edx, DWORD PTR [ecx]
	mov	eax, DWORD PTR _this$[esp-4]
	mov	edx, DWORD PTR [edx+52]
	push	ecx
	fstp	DWORD PTR [esp]
	push	1
	push	0
	push	eax
	call	edx
	ret	4
?play@ref_sound@@QAEXPAVCObject@@IM@Z ENDP		; ref_sound::play
; Function compile flags: /Ogtpy
; File j:\msvs8\vc\include\math.h
_TEXT	ENDS
;	COMDAT _tanf
_TEXT	SEGMENT
__X$ = 8						; size = 4
_tanf	PROC						; COMDAT

; 425  :         {return ((float)tan((double)_X)); }

	fld	DWORD PTR __X$[esp-4]
	fptan
	fstp	ST(0)
	ret	0
_tanf	ENDP
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_algobase.h
_TEXT	ENDS
;	COMDAT ??$fill@PAUParticle@CEffect_Rain@@U12@@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU12@@Z
_TEXT	SEGMENT
??$fill@PAUParticle@CEffect_Rain@@U12@@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU12@@Z PROC ; stlp_std::fill<CEffect_Rain::Particle *,CEffect_Rain::Particle>, COMDAT
; ___first$ = eax
; ___last$ = edx
; ___val$ = ebx

; 393  :   _STLP_DEBUG_CHECK(_STLP_PRIV __check_range(__first, __last))
; 394  :   for ( ; __first != __last; ++__first)

	cmp	eax, edx
	je	SHORT $LN1@fill@4
	push	esi
	push	edi
$LL3@fill@4:

; 395  :     *__first = __val;

	mov	edi, eax
	add	eax, 92					; 0000005cH
	cmp	eax, edx
	mov	ecx, 23					; 00000017H
	mov	esi, ebx
	rep movsd
	jne	SHORT $LL3@fill@4
	pop	edi
	pop	esi
$LN1@fill@4:

; 396  : }

	ret	0
??$fill@PAUParticle@CEffect_Rain@@U12@@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU12@@Z ENDP ; stlp_std::fill<CEffect_Rain::Particle *,CEffect_Rain::Particle>
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??$__fill_n@PAUParticle@CEffect_Rain@@IU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@IABU23@@Z
_TEXT	SEGMENT
??$__fill_n@PAUParticle@CEffect_Rain@@IU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@IABU23@@Z PROC ; stlp_std::priv::__fill_n<CEffect_Rain::Particle *,unsigned int,CEffect_Rain::Particle>, COMDAT
; ___first$ = eax
; ___n$ = edx
; ___val$ = ebx

; 403  :   _STLP_FIX_LITERAL_BUG(__first)
; 404  :   for ( ; __n > 0; --__n, ++__first)

	test	edx, edx
	jbe	SHORT $LN1@fill_n@12
	push	esi
	push	edi
$LL3@fill_n@12:

; 405  :     *__first = __val;

	mov	edi, eax
	sub	edx, 1
	mov	ecx, 23					; 00000017H
	mov	esi, ebx
	add	eax, 92					; 0000005cH
	test	edx, edx
	rep movsd
	ja	SHORT $LL3@fill_n@12
	pop	edi
	pop	esi
$LN1@fill_n@12:

; 406  :   return __first;
; 407  : }

	ret	0
??$__fill_n@PAUParticle@CEffect_Rain@@IU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@IABU23@@Z ENDP ; stlp_std::priv::__fill_n<CEffect_Rain::Particle *,unsigned int,CEffect_Rain::Particle>
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_vector.h
_TEXT	ENDS
;	COMDAT ?_M_set@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@00@Z
_TEXT	SEGMENT
___e$ = 8						; size = 4
?_M_set@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@00@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_set, COMDAT
; _this$ = eax
; ___s$ = ecx
; ___f$ = edx

; 626  :     this->_M_start = __s;

	mov	DWORD PTR [eax], ecx

; 627  :     this->_M_finish = __f;
; 628  :     this->_M_end_of_storage._M_data = __e;

	mov	ecx, DWORD PTR ___e$[esp-4]
	mov	DWORD PTR [eax+4], edx
	mov	DWORD PTR [eax+8], ecx

; 629  :   }

	ret	4
?_M_set@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@00@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_set
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?_M_is_inside@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@ABE_NABUParticle@CEffect_Rain@@@Z
_TEXT	SEGMENT
?_M_is_inside@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@ABE_NABUParticle@CEffect_Rain@@@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_is_inside, COMDAT
; _this$ = ecx
; ___x$ = eax

; 393  :     return (&__x >= this->_M_start && &__x < this->_M_finish);

	cmp	eax, DWORD PTR [ecx]
	jb	SHORT $LN3@M_is_insid@7
	cmp	eax, DWORD PTR [ecx+4]
	jae	SHORT $LN3@M_is_insid@7
	mov	eax, 1

; 394  :   }

	ret	0
$LN3@M_is_insid@7:

; 393  :     return (&__x >= this->_M_start && &__x < this->_M_finish);

	xor	eax, eax

; 394  :   }

	ret	0
?_M_is_inside@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@ABE_NABUParticle@CEffect_Rain@@@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_is_inside
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrcore\_std_extensions.h
_TEXT	ENDS
;	COMDAT ??$_max@M@@YAMMM@Z
_TEXT	SEGMENT
??$_max@M@@YAMMM@Z PROC					; _max<float>, COMDAT
; _a$ = xmm0s
; _b$ = xmm1s

; 95   : template <class T>	IC T		_max	(T a, T b)	{ return a>b?a:b;	}

	comiss	xmm0, xmm1
	ja	SHORT $LN4@max
	movaps	xmm0, xmm1
$LN4@max:
	ret	0
??$_max@M@@YAMMM@Z ENDP					; _max<float>
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\pointers\_tools.h
_TEXT	ENDS
;	COMDAT ?to_value_type_ptr@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAPAUParticle@CEffect_Rain@@PAU45@@Z
_TEXT	SEGMENT
?to_value_type_ptr@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAPAUParticle@CEffect_Rain@@PAU45@@Z PROC ; stlp_std::priv::_CastTraits<CEffect_Rain::Particle,CEffect_Rain::Particle>::to_value_type_ptr, COMDAT
; ___ptr$ = eax

; 237  :   { return __ptr; }

	ret	0
?to_value_type_ptr@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAPAUParticle@CEffect_Rain@@PAU45@@Z ENDP ; stlp_std::priv::_CastTraits<CEffect_Rain::Particle,CEffect_Rain::Particle>::to_value_type_ptr
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?to_storage_type_cref@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAABUParticle@CEffect_Rain@@ABU45@@Z
_TEXT	SEGMENT
?to_storage_type_cref@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAABUParticle@CEffect_Rain@@ABU45@@Z PROC ; stlp_std::priv::_CastTraits<CEffect_Rain::Particle,CEffect_Rain::Particle>::to_storage_type_cref, COMDAT
; ___ref$ = eax

; 254  :   { return __ref; }

	ret	0
?to_storage_type_cref@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAABUParticle@CEffect_Rain@@ABU45@@Z ENDP ; stlp_std::priv::_CastTraits<CEffect_Rain::Particle,CEffect_Rain::Particle>::to_storage_type_cref
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?to_value_type_ref@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAAAUParticle@CEffect_Rain@@AAU45@@Z
_TEXT	SEGMENT
?to_value_type_ref@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAAAUParticle@CEffect_Rain@@AAU45@@Z PROC ; stlp_std::priv::_CastTraits<CEffect_Rain::Particle,CEffect_Rain::Particle>::to_value_type_ref, COMDAT
; ___ref$ = eax

; 243  :   { return __ref; }

	ret	0
?to_value_type_ref@?$_CastTraits@UParticle@CEffect_Rain@@U12@@priv@stlp_std@@SAAAUParticle@CEffect_Rain@@AAU45@@Z ENDP ; stlp_std::priv::_CastTraits<CEffect_Rain::Particle,CEffect_Rain::Particle>::to_value_type_ref
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrcore\_stl_extensions.h
_TEXT	ENDS
;	COMDAT ??0?$xalloc@UParticle@CEffect_Rain@@@@QAE@XZ
_TEXT	SEGMENT
??0?$xalloc@UParticle@CEffect_Rain@@@@QAE@XZ PROC	; xalloc<CEffect_Rain::Particle>::xalloc<CEffect_Rain::Particle>, COMDAT
; _this$ = eax

; 77   : 													xalloc			()										{	}

	ret	0
??0?$xalloc@UParticle@CEffect_Rain@@@@QAE@XZ ENDP	; xalloc<CEffect_Rain::Particle>::xalloc<CEffect_Rain::Particle>
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??0?$xalloc@UItem@CEffect_Rain@@@@QAE@XZ
_TEXT	SEGMENT
??0?$xalloc@UItem@CEffect_Rain@@@@QAE@XZ PROC		; xalloc<CEffect_Rain::Item>::xalloc<CEffect_Rain::Item>, COMDAT
; _this$ = eax

; 77   : 													xalloc			()										{	}

	ret	0
??0?$xalloc@UItem@CEffect_Rain@@@@QAE@XZ ENDP		; xalloc<CEffect_Rain::Item>::xalloc<CEffect_Rain::Item>
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\include\xrrender\factoryptr.h
_TEXT	ENDS
;	COMDAT ??C?$FactoryPtr@VIRainRender@@@@QBEPAVIRainRender@@XZ
_TEXT	SEGMENT
??C?$FactoryPtr@VIRainRender@@@@QBEPAVIRainRender@@XZ PROC ; FactoryPtr<IRainRender>::operator->, COMDAT
; _this$ = eax

; 40   : 	T* operator->() const {return m_pObject;}

	mov	eax, DWORD PTR [eax]
	ret	0
??C?$FactoryPtr@VIRainRender@@@@QBEPAVIRainRender@@XZ ENDP ; FactoryPtr<IRainRender>::operator->
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrcore\_vector3d.h
_TEXT	ENDS
;	COMDAT ?mad@?$_vector3@M@@QAEAAU1@ABU1@0M@Z
_TEXT	SEGMENT
?mad@?$_vector3@M@@QAEAAU1@ABU1@0M@Z PROC		; _vector3<float>::mad, COMDAT
; _this$ = eax
; _p$ = edx
; _d$ = ecx
; _m$ = xmm0s

; 144  : 		x = p.x + d.x*m;

	movss	xmm1, DWORD PTR [ecx]
	mulss	xmm1, xmm0
	addss	xmm1, DWORD PTR [edx]
	movss	DWORD PTR [eax], xmm1

; 145  : 		y = p.y + d.y*m;

	movss	xmm1, DWORD PTR [ecx+4]
	mulss	xmm1, xmm0
	addss	xmm1, DWORD PTR [edx+4]
	movss	DWORD PTR [eax+4], xmm1

; 146  : 		z = p.z + d.z*m;

	movss	xmm1, DWORD PTR [ecx+8]
	mulss	xmm1, xmm0
	addss	xmm1, DWORD PTR [edx+8]
	movss	DWORD PTR [eax+8], xmm1

; 147  : 		return *this;	
; 148  : 	}

	ret	0
?mad@?$_vector3@M@@QAEAAU1@ABU1@0M@Z ENDP		; _vector3<float>::mad
_TEXT	ENDS
PUBLIC	?p_size@CEffect_Rain@@AAEHPAUParticle@1@@Z	; CEffect_Rain::p_size
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrengine\rain.cpp
;	COMDAT ?p_size@CEffect_Rain@@AAEHPAUParticle@1@@Z
_TEXT	SEGMENT
_P$ = 8							; size = 4
?p_size@CEffect_Rain@@AAEHPAUParticle@1@@Z PROC		; CEffect_Rain::p_size, COMDAT
; _this$ = ecx

; 462  : 	if (0==P)	return 0;

	mov	ecx, DWORD PTR _P$[esp-4]
	xor	eax, eax
	test	ecx, ecx
	je	SHORT $LN4@p_size
	npad	6
$LL2@p_size:

; 463  : 	int cnt = 0;
; 464  : 	while (P)	{
; 465  : 		P	=	P->next;

	mov	ecx, DWORD PTR [ecx]

; 466  : 		cnt +=	1;

	add	eax, 1
	test	ecx, ecx
	jne	SHORT $LL2@p_size
$LN4@p_size:

; 467  : 	}
; 468  : 	return cnt;
; 469  : }

	ret	4
?p_size@CEffect_Rain@@AAEHPAUParticle@1@@Z ENDP		; CEffect_Rain::p_size
_TEXT	ENDS
PUBLIC	?p_insert@CEffect_Rain@@AAEXPAUParticle@1@AAPAU21@@Z ; CEffect_Rain::p_insert
; Function compile flags: /Ogtpy
;	COMDAT ?p_insert@CEffect_Rain@@AAEXPAUParticle@1@AAPAU21@@Z
_TEXT	SEGMENT
_P$ = 8							; size = 4
_LST$ = 12						; size = 4
?p_insert@CEffect_Rain@@AAEXPAUParticle@1@AAPAU21@@Z PROC ; CEffect_Rain::p_insert, COMDAT
; _this$ = ecx

; 452  : 	VERIFY		(P);
; 453  : 	P->prev					= 0;

	mov	eax, DWORD PTR _P$[esp-4]

; 454  : 	P->next					= LST;

	mov	ecx, DWORD PTR _LST$[esp-4]
	mov	DWORD PTR [eax+4], 0
	mov	edx, DWORD PTR [ecx]
	mov	DWORD PTR [eax], edx

; 455  : 	if (LST)	LST->prev	= P;

	mov	edx, DWORD PTR [ecx]
	test	edx, edx
	je	SHORT $LN7@p_insert
	mov	DWORD PTR [edx+4], eax
$LN7@p_insert:

; 456  : 	LST						= P;

	mov	DWORD PTR [ecx], eax

; 457  : }

	ret	8
?p_insert@CEffect_Rain@@AAEXPAUParticle@1@AAPAU21@@Z ENDP ; CEffect_Rain::p_insert
_TEXT	ENDS
PUBLIC	?p_remove@CEffect_Rain@@AAEXPAUParticle@1@AAPAU21@@Z ; CEffect_Rain::p_remove
; Function compile flags: /Ogtpy
;	COMDAT ?p_remove@CEffect_Rain@@AAEXPAUParticle@1@AAPAU21@@Z
_TEXT	SEGMENT
_P$ = 8							; size = 4
_LST$ = 12						; size = 4
?p_remove@CEffect_Rain@@AAEXPAUParticle@1@AAPAU21@@Z PROC ; CEffect_Rain::p_remove, COMDAT
; _this$ = ecx

; 441  : 	VERIFY		(P);
; 442  : 	Particle*	prev		= P->prev;	P->prev = NULL;

	mov	eax, DWORD PTR _P$[esp-4]
	mov	ecx, DWORD PTR [eax+4]

; 443  : 	Particle*	next		= P->next;	P->next	= NULL;
; 444  : 	if (prev) prev->next	= next;

	test	ecx, ecx
	mov	edx, DWORD PTR [eax]
	mov	DWORD PTR [eax+4], 0
	mov	DWORD PTR [eax], 0
	je	SHORT $LN3@p_remove
	mov	DWORD PTR [ecx], edx
$LN3@p_remove:

; 445  : 	if (next) next->prev	= prev;

	test	edx, edx
	je	SHORT $LN2@p_remove
	mov	DWORD PTR [edx+4], ecx
$LN2@p_remove:

; 446  : 	if (LST==P)	LST			= next;

	mov	ecx, DWORD PTR _LST$[esp-4]
	cmp	DWORD PTR [ecx], eax
	jne	SHORT $LN1@p_remove
	mov	DWORD PTR [ecx], edx
$LN1@p_remove:

; 447  : }

	ret	8
?p_remove@CEffect_Rain@@AAEXPAUParticle@1@AAPAU21@@Z ENDP ; CEffect_Rain::p_remove
_TEXT	ENDS
PUBLIC	?Render@CEffect_Rain@@QAEXXZ			; CEffect_Rain::Render
; Function compile flags: /Ogtpy
;	COMDAT ?Render@CEffect_Rain@@QAEXXZ
_TEXT	SEGMENT
?Render@CEffect_Rain@@QAEXXZ PROC			; CEffect_Rain::Render, COMDAT
; _this$ = ecx

; 186  : #ifndef _EDITOR
; 187  : 	if (!g_pGameLevel)			return;

	cmp	DWORD PTR ?g_pGameLevel@@3PAVIGame_Level@@A, 0 ; g_pGameLevel
	je	SHORT $LN2@Render@3

; 188  : #endif
; 189  : 
; 190  : 	m_pRender->Render(*this);

	mov	eax, DWORD PTR [ecx]
	mov	edx, DWORD PTR [eax]
	push	ecx
	mov	ecx, eax
	mov	eax, DWORD PTR [edx+8]
	call	eax
$LN2@Render@3:

; 191  : 
; 192  : 	/*
; 193  : 	float	factor				= g_pGamePersistent->Environment().CurrentEnv->rain_density;
; 194  : 	if (factor<EPS_L)			return;
; 195  : 
; 196  : 	u32 desired_items			= iFloor	(0.5f*(1.f+factor)*float(max_desired_items));
; 197  : 	// visual
; 198  : 	float		factor_visual	= factor/2.f+.5f;
; 199  : 	Fvector3	f_rain_color	= g_pGamePersistent->Environment().CurrentEnv->rain_color;
; 200  : 	u32			u_rain_color	= color_rgba_f(f_rain_color.x,f_rain_color.y,f_rain_color.z,factor_visual);
; 201  : 
; 202  : 	// born _new_ if needed
; 203  : 	float	b_radius_wrap_sqr	= _sqr((source_radius+.5f));
; 204  : 	if (items.size()<desired_items)	{
; 205  : 		// items.reserve		(desired_items);
; 206  : 		while (items.size()<desired_items)	{
; 207  : 			Item				one;
; 208  : 			Born				(one,source_radius);
; 209  : 			items.push_back		(one);
; 210  : 		}
; 211  : 	}
; 212  : 
; 213  : 	// build source plane
; 214  :     Fplane src_plane;
; 215  :     Fvector norm	={0.f,-1.f,0.f};
; 216  :     Fvector upper; 	upper.set(Device.vCameraPosition.x,Device.vCameraPosition.y+source_offset,Device.vCameraPosition.z);
; 217  :     src_plane.build(upper,norm);
; 218  : 	
; 219  : 	// perform update
; 220  : 	u32			vOffset;
; 221  : 	FVF::LIT	*verts		= (FVF::LIT	*) RCache.Vertex.Lock(desired_items*4,hGeom_Rain->vb_stride,vOffset);
; 222  : 	FVF::LIT	*start		= verts;
; 223  : 	const Fvector&	vEye	= Device.vCameraPosition;
; 224  : 	for (u32 I=0; I<items.size(); I++){
; 225  : 		// physics and time control
; 226  : 		Item&	one		=	items[I];
; 227  : 
; 228  : 		if (one.dwTime_Hit<Device.dwTimeGlobal)		Hit (one.Phit);
; 229  : 		if (one.dwTime_Life<Device.dwTimeGlobal)	Born(one,source_radius);
; 230  : 
; 231  : // последн€€ дельта ??
; 232  : //.		float xdt		= float(one.dwTime_Hit-Device.dwTimeGlobal)/1000.f;
; 233  : //.		float dt		= Device.fTimeDelta;//xdt<Device.fTimeDelta?xdt:Device.fTimeDelta;
; 234  : 		float dt		= Device.fTimeDelta;
; 235  : 		one.P.mad		(one.D,one.fSpeed*dt);
; 236  : 
; 237  : 		Device.Statistic->TEST1.Begin();
; 238  : 		Fvector	wdir;	wdir.set(one.P.x-vEye.x,0,one.P.z-vEye.z);
; 239  : 		float	wlen	= wdir.square_magnitude();
; 240  : 		if (wlen>b_radius_wrap_sqr)	{
; 241  : 			wlen		= _sqrt(wlen);
; 242  : //.			Device.Statistic->TEST3.Begin();
; 243  : 			if ((one.P.y-vEye.y)<sink_offset){
; 244  : 				// need born
; 245  : 				one.invalidate();
; 246  : 			}else{
; 247  : 				Fvector		inv_dir, src_p;
; 248  : 				inv_dir.invert(one.D);
; 249  : 				wdir.div	(wlen);
; 250  : 				one.P.mad	(one.P, wdir, -(wlen+source_radius));
; 251  : 				if (src_plane.intersectRayPoint(one.P,inv_dir,src_p)){
; 252  : 					float dist_sqr	= one.P.distance_to_sqr(src_p);
; 253  : 					float height	= max_distance;
; 254  : 					if (RayPick(src_p,one.D,height,collide::rqtBoth)){	
; 255  : 						if (_sqr(height)<=dist_sqr){ 
; 256  : 							one.invalidate	();								// need born
; 257  : //							Log("1");
; 258  : 						}else{	
; 259  : 							RenewItem	(one,height-_sqrt(dist_sqr),TRUE);		// fly to point
; 260  : //							Log("2",height-dist);
; 261  : 						}
; 262  : 					}else{
; 263  : 						RenewItem		(one,max_distance-_sqrt(dist_sqr),FALSE);		// fly ...
; 264  : //						Log("3",1.5f*b_height-dist);
; 265  : 					}
; 266  : 				}else{
; 267  : 					// need born
; 268  : 					one.invalidate();
; 269  : //					Log("4");
; 270  : 				}
; 271  : 			}
; 272  : //.			Device.Statistic->TEST3.End();
; 273  : 		}
; 274  : 		Device.Statistic->TEST1.End();
; 275  : 
; 276  : 		// Build line
; 277  : 		Fvector&	pos_head	= one.P;
; 278  : 		Fvector		pos_trail;	pos_trail.mad	(pos_head,one.D,-drop_length*factor_visual);
; 279  : 		
; 280  : 		// Culling
; 281  : 		Fvector sC,lineD;	float sR; 
; 282  : 		sC.sub			(pos_head,pos_trail);
; 283  : 		lineD.normalize	(sC);
; 284  : 		sC.mul			(.5f);
; 285  : 		sR				= sC.magnitude();
; 286  : 		sC.add			(pos_trail);
; 287  : 		if (!::Render->ViewBase.testSphere_dirty(sC,sR))	continue;
; 288  : 		
; 289  : 		static Fvector2 UV[2][4]={
; 290  : 			{{0,1},{0,0},{1,1},{1,0}},
; 291  : 			{{1,0},{1,1},{0,0},{0,1}}
; 292  : 		};
; 293  : 
; 294  : 		// Everything OK - build vertices
; 295  : 		Fvector	P,lineTop,camDir;
; 296  : 		camDir.sub			(sC,vEye);
; 297  : 		camDir.normalize	();
; 298  : 		lineTop.crossproduct(camDir,lineD);
; 299  : 		float w = drop_width;
; 300  : 		u32 s	= one.uv_set;
; 301  : 		P.mad(pos_trail,lineTop,-w);	verts->set(P,u_rain_color,UV[s][0].x,UV[s][0].y);	verts++;
; 302  : 		P.mad(pos_trail,lineTop,w);		verts->set(P,u_rain_color,UV[s][1].x,UV[s][1].y);	verts++;
; 303  : 		P.mad(pos_head, lineTop,-w);	verts->set(P,u_rain_color,UV[s][2].x,UV[s][2].y);	verts++;
; 304  : 		P.mad(pos_head, lineTop,w);		verts->set(P,u_rain_color,UV[s][3].x,UV[s][3].y);	verts++;
; 305  : 	}
; 306  : 	u32 vCount					= (u32)(verts-start);
; 307  : 	RCache.Vertex.Unlock		(vCount,hGeom_Rain->vb_stride);
; 308  : 	
; 309  : 	// Render if needed
; 310  : 	if (vCount)	{
; 311  : 		HW.pDevice->SetRenderState	(D3DRS_CULLMODE,D3DCULL_NONE);
; 312  : 		RCache.set_xform_world		(Fidentity);
; 313  : 		RCache.set_Shader			(SH_Rain);
; 314  : 		RCache.set_Geometry			(hGeom_Rain);
; 315  : 		RCache.Render				(D3DPT_TRIANGLELIST,vOffset,0,vCount,0,vCount/2);
; 316  : 		HW.pDevice->SetRenderState	(D3DRS_CULLMODE,D3DCULL_CCW);
; 317  : 	}
; 318  : 	
; 319  : 	// Particles
; 320  : 	Particle*	P		= particle_active;
; 321  : 	if (0==P)			return;
; 322  : 	
; 323  : 	{
; 324  : 		float	dt				= Device.fTimeDelta;
; 325  : 		_IndexStream& _IS		= RCache.Index;
; 326  : 		RCache.set_Shader		(DM_Drop->shader);
; 327  : 		
; 328  : 		Fmatrix					mXform,mScale;
; 329  : 		int						pcount  = 0;
; 330  : 		u32						v_offset,i_offset;
; 331  : 		u32						vCount_Lock		= particles_cache*DM_Drop->number_vertices;
; 332  : 		u32						iCount_Lock		= particles_cache*DM_Drop->number_indices;
; 333  : 		IRender_DetailModel::fvfVertexOut* v_ptr= (IRender_DetailModel::fvfVertexOut*) RCache.Vertex.Lock	(vCount_Lock, hGeom_Drops->vb_stride, v_offset);
; 334  : 		u16*					i_ptr			= _IS.Lock													(iCount_Lock, i_offset);
; 335  : 		while (P)	{
; 336  : 			Particle*	next	=	P->next;
; 337  : 			
; 338  : 			// Update
; 339  : 			// P can be zero sometimes and it crashes
; 340  : 			P->time				-=	dt;
; 341  : 			if (P->time<0)	{
; 342  : 				p_free			(P);
; 343  : 				P				=	next;
; 344  : 				continue;
; 345  : 			}
; 346  : 
; 347  : 			// Render
; 348  : 			if (::Render->ViewBase.testSphere_dirty(P->bounds.P, P->bounds.R))
; 349  : 			{
; 350  : 				// Build matrix
; 351  : 				float scale			=	P->time / particles_time;
; 352  : 				mScale.scale		(scale,scale,scale);
; 353  : 				mXform.mul_43		(P->mXForm,mScale);
; 354  : 				
; 355  : 				// XForm verts
; 356  : 				DM_Drop->transfer	(mXform,v_ptr,u_rain_color,i_ptr,pcount*DM_Drop->number_vertices);
; 357  : 				v_ptr			+=	DM_Drop->number_vertices;
; 358  : 				i_ptr			+=	DM_Drop->number_indices;
; 359  : 				pcount			++;
; 360  : 
; 361  : 				if (pcount >= particles_cache) {
; 362  : 					// flush
; 363  : 					u32	dwNumPrimitives		= iCount_Lock/3;
; 364  : 					RCache.Vertex.Unlock	(vCount_Lock,hGeom_Drops->vb_stride);
; 365  : 					_IS.Unlock				(iCount_Lock);
; 366  : 					RCache.set_Geometry		(hGeom_Drops);
; 367  : 					RCache.Render			(D3DPT_TRIANGLELIST,v_offset, 0,vCount_Lock,i_offset,dwNumPrimitives);
; 368  : 					
; 369  : 					v_ptr					= (IRender_DetailModel::fvfVertexOut*)			RCache.Vertex.Lock	(vCount_Lock, hGeom_Drops->vb_stride, v_offset);
; 370  : 					i_ptr					= _IS.Lock										(iCount_Lock, i_offset);
; 371  : 					
; 372  : 					pcount	= 0;
; 373  : 				}
; 374  : 			}
; 375  : 			
; 376  : 			P = next;
; 377  : 		}
; 378  : 
; 379  : 		// Flush if needed
; 380  : 		vCount_Lock						= pcount*DM_Drop->number_vertices;
; 381  : 		iCount_Lock						= pcount*DM_Drop->number_indices;
; 382  : 		u32	dwNumPrimitives				= iCount_Lock/3;
; 383  : 		RCache.Vertex.Unlock			(vCount_Lock,hGeom_Drops->vb_stride);
; 384  : 		_IS.Unlock						(iCount_Lock);
; 385  : 		if (pcount)	{
; 386  : 			RCache.set_Geometry		(hGeom_Drops);
; 387  : 			RCache.Render			(D3DPT_TRIANGLELIST,v_offset,0,vCount_Lock,i_offset,dwNumPrimitives);
; 388  : 		}
; 389  : 	}
; 390  : 	*/
; 391  : }

	ret	0
?Render@CEffect_Rain@@QAEXXZ ENDP			; CEffect_Rain::Render
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_construct.h
;	COMDAT ??$_Param_Construct@UParticle@CEffect_Rain@@U12@@stlp_std@@YAXPAUParticle@CEffect_Rain@@ABU12@@Z
_TEXT	SEGMENT
??$_Param_Construct@UParticle@CEffect_Rain@@U12@@stlp_std@@YAXPAUParticle@CEffect_Rain@@ABU12@@Z PROC ; stlp_std::_Param_Construct<CEffect_Rain::Particle,CEffect_Rain::Particle>, COMDAT
; ___p$ = eax
; ___val$ = edx

; 117  : inline void _Param_Construct(_T1* __p, const _T2& __val) {

	push	edi
	mov	edi, eax

; 118  : #if defined (_STLP_DEBUG_UNINITIALIZED)
; 119  :   memset((char*)__p, _STLP_SHRED_BYTE, sizeof(_T1));
; 120  : #endif
; 121  :   _STLP_PLACEMENT_NEW (__p) _T1(__val);

	test	edi, edi
	je	SHORT $LN3@Param_Cons@6
	push	esi
	mov	ecx, 23					; 00000017H
	mov	esi, edx
	rep movsd
	pop	esi
$LN3@Param_Cons@6:
	pop	edi

; 122  : }

	ret	0
??$_Param_Construct@UParticle@CEffect_Rain@@U12@@stlp_std@@YAXPAUParticle@CEffect_Rain@@ABU12@@Z ENDP ; stlp_std::_Param_Construct<CEffect_Rain::Particle,CEffect_Rain::Particle>
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_uninitialized.h
_TEXT	ENDS
;	COMDAT ??$__ufill@PAUParticle@CEffect_Rain@@U12@H@priv@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU23@ABUrandom_access_iterator_tag@1@PAH@Z
_TEXT	SEGMENT
___x$ = 8						; size = 4
??$__ufill@PAUParticle@CEffect_Rain@@U12@H@priv@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU23@ABUrandom_access_iterator_tag@1@PAH@Z PROC ; stlp_std::priv::__ufill<CEffect_Rain::Particle *,CEffect_Rain::Particle,int>, COMDAT
; ___first$ = ecx
; ___last$ = eax

; 246  :                     const _Tp& __x, const random_access_iterator_tag &, _Distance*) {

	push	ebx
	mov	ebx, ecx

; 247  :   _ForwardIter __cur = __first;
; 248  :   _STLP_TRY {
; 249  :     for (_Distance __n = __last - __first; __n > 0; --__n, ++__cur)

	sub	eax, ebx
	mov	ecx, eax
	mov	eax, -1307163959			; b21642c9H
	imul	ecx
	add	edx, ecx
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	add	eax, edx
	test	eax, eax
	push	ebp
	mov	ebp, DWORD PTR ___x$[esp+4]
	jle	SHORT $LN1@ufill@4
	push	esi
	push	edi
$LL3@ufill@4:

; 250  :       _Param_Construct(&*__cur, __x);

	test	ebx, ebx
	je	SHORT $LN2@ufill@4
	mov	ecx, 23					; 00000017H
	mov	esi, ebp
	mov	edi, ebx
	rep movsd
$LN2@ufill@4:
	sub	eax, 1
	add	ebx, 92					; 0000005cH
	test	eax, eax
	jg	SHORT $LL3@ufill@4
	pop	edi
	pop	esi
$LN1@ufill@4:
	pop	ebp
	pop	ebx

; 251  :   }
; 252  :   _STLP_UNWIND(_STLP_STD::_Destroy_Range(__first, __cur))
; 253  : }

	ret	0
??$__ufill@PAUParticle@CEffect_Rain@@U12@H@priv@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU23@ABUrandom_access_iterator_tag@1@PAH@Z ENDP ; stlp_std::priv::__ufill<CEffect_Rain::Particle *,CEffect_Rain::Particle,int>
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??$__uninitialized_fill_n@PAUParticle@CEffect_Rain@@IU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@IABU23@@Z
_TEXT	SEGMENT
___x$ = 8						; size = 4
??$__uninitialized_fill_n@PAUParticle@CEffect_Rain@@IU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@IABU23@@Z PROC ; stlp_std::priv::__uninitialized_fill_n<CEffect_Rain::Particle *,unsigned int,CEffect_Rain::Particle>, COMDAT
; ___first$ = ecx
; ___n$ = eax

; 314  :   _ForwardIter __last = __first + __n;

	imul	eax, 92					; 0000005cH
	add	eax, ecx
	push	esi
	mov	esi, eax

; 315  :   __ufill(__first, __last, __x, random_access_iterator_tag(), (ptrdiff_t*)0);

	mov	eax, DWORD PTR ___x$[esp]
	push	eax
	mov	eax, esi
	call	??$__ufill@PAUParticle@CEffect_Rain@@U12@H@priv@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU23@ABUrandom_access_iterator_tag@1@PAH@Z ; stlp_std::priv::__ufill<CEffect_Rain::Particle *,CEffect_Rain::Particle,int>
	add	esp, 4

; 316  :   return __last;

	mov	eax, esi
	pop	esi

; 317  : }

	ret	0
??$__uninitialized_fill_n@PAUParticle@CEffect_Rain@@IU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@IABU23@@Z ENDP ; stlp_std::priv::__uninitialized_fill_n<CEffect_Rain::Particle *,unsigned int,CEffect_Rain::Particle>
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_algobase.h
_TEXT	ENDS
;	COMDAT ??$__copy_backward_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z
_TEXT	SEGMENT
??$__copy_backward_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z PROC ; stlp_std::priv::__copy_backward_ptrs<CEffect_Rain::Particle *,CEffect_Rain::Particle *>, COMDAT
; ___first$ = edx
; ___last$ = ecx
; ___result$ = eax

; 294  :   return (_OutputIter)__copy_trivial_backward(__first, __last, __result);

	sub	ecx, edx
	test	ecx, ecx
	jle	SHORT $LN6@copy_backw@25
	push	ecx
	push	edx
	sub	eax, ecx
	push	eax
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
$LN6@copy_backw@25:

; 295  : }

	ret	0
??$__copy_backward_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z ENDP ; stlp_std::priv::__copy_backward_ptrs<CEffect_Rain::Particle *,CEffect_Rain::Particle *>
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_uninitialized.h
_TEXT	ENDS
;	COMDAT ??$__ucopy_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z
_TEXT	SEGMENT
??$__ucopy_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z PROC ; stlp_std::priv::__ucopy_ptrs<CEffect_Rain::Particle *,CEffect_Rain::Particle *>, COMDAT
; ___first$ = ecx
; ___last$ = edx
; ___result$ = eax

; 117  :                                 const __true_type& /*TrivialUCopy*/) {

	push	esi
	mov	esi, edx

; 118  :   // we know they all pointers, so this cast is OK
; 119  :   //  return (_OutputIter)__copy_trivial(&(*__first), &(*__last), &(*__result));
; 120  :   return (_OutputIter)__ucopy_trivial(__first, __last, __result);

	cmp	esi, ecx
	je	SHORT $LN6@ucopy_ptrs@10
	sub	esi, ecx
	push	esi
	push	ecx
	push	eax
	call	_memcpy
	add	esp, 12					; 0000000cH
	add	eax, esi
$LN6@ucopy_ptrs@10:
	pop	esi

; 121  : }

	ret	0
??$__ucopy_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z ENDP ; stlp_std::priv::__ucopy_ptrs<CEffect_Rain::Particle *,CEffect_Rain::Particle *>
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_vector.c
_TEXT	ENDS
;	COMDAT ?_M_fill_insert_aux@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@ABU__false_type@3@@Z
_TEXT	SEGMENT
___x_copy$135453 = -92					; size = 92
tv268 = 8						; size = 4
___last$251572 = 8					; size = 4
___pos$ = 8						; size = 4
___n$ = 12						; size = 4
$T251518 = 16						; size = 1
___x$ = 16						; size = 4
___formal$ = 20						; size = 4
?_M_fill_insert_aux@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@ABU__false_type@3@@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert_aux, COMDAT
; _this$ = ecx

; 143  :                                               const _Tp& __x, const __false_type& /*_Movable*/) {

	sub	esp, 92					; 0000005cH
	push	ebp
	mov	ebp, ecx

; 144  :   //Here self referencing needs to be checked even for non movable types.
; 145  :   if (_M_is_inside(__x)) {

	mov	ecx, DWORD PTR ___x$[esp+92]
	cmp	ecx, DWORD PTR [ebp]
	push	esi
	push	edi
	jb	SHORT $LN3@M_fill_ins@5
	cmp	ecx, DWORD PTR [ebp+4]
	jae	SHORT $LN3@M_fill_ins@5

; 146  :     _Tp __x_copy = __x;

	mov	esi, DWORD PTR ___x$[esp+100]

; 147  :     _M_fill_insert_aux(__pos, __n, __x_copy, __false_type());

	mov	edx, DWORD PTR ___n$[esp+100]
	mov	ecx, 23					; 00000017H
	lea	edi, DWORD PTR ___x_copy$135453[esp+104]
	rep movsd
	lea	eax, DWORD PTR $T251518[esp+100]
	push	eax
	mov	eax, DWORD PTR ___pos$[esp+104]
	lea	ecx, DWORD PTR ___x_copy$135453[esp+108]
	push	ecx
	push	edx
	push	eax
	mov	ecx, ebp
	mov	BYTE PTR $T251518[esp+116], 0
	call	?_M_fill_insert_aux@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@ABU__false_type@3@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert_aux
	pop	edi
	pop	esi
	pop	ebp

; 162  :   }
; 163  : }

	add	esp, 92					; 0000005cH
	ret	16					; 00000010H
$LN3@M_fill_ins@5:

; 148  :     return;
; 149  :   }
; 150  :   const size_type __elems_after = this->_M_finish - __pos;

	mov	edi, DWORD PTR ___pos$[esp+100]
	push	ebx
	mov	ebx, DWORD PTR [ebp+4]
	mov	esi, ebx
	sub	esi, edi
	mov	eax, -1307163959			; b21642c9H
	imul	esi

; 151  :   pointer __old_finish = this->_M_finish;
; 152  :   if (__elems_after > __n) {

	mov	eax, DWORD PTR ___n$[esp+104]
	add	edx, esi
	sar	edx, 6
	mov	esi, edx
	shr	esi, 31					; 0000001fH
	add	esi, edx
	cmp	esi, eax
	jbe	SHORT $LN2@M_fill_ins@5

; 153  :     _STLP_PRIV __ucopy_ptrs(this->_M_finish - __n, this->_M_finish, this->_M_finish, _TrivialUCopy());

	mov	ecx, eax
	imul	ecx, 92					; 0000005cH
	mov	esi, ebx
	sub	esi, ecx
	cmp	ebx, esi
	mov	DWORD PTR tv268[esp+104], ecx
	je	SHORT $LN15@M_fill_ins@5
	mov	ecx, ebx
	sub	ecx, esi
	push	ecx
	push	esi
	push	ebx
	call	_memcpy
	mov	ecx, DWORD PTR tv268[esp+116]
	add	esp, 12					; 0000000cH
$LN15@M_fill_ins@5:

; 154  :     this->_M_finish += __n;

	add	DWORD PTR [ebp+4], ecx

; 155  :     _STLP_PRIV __copy_backward_ptrs(__pos, __old_finish - __n, __old_finish, _TrivialCopy());

	sub	esi, edi
	test	esi, esi
	jle	SHORT $LN20@M_fill_ins@5
	push	esi
	push	edi
	sub	ebx, esi
	push	ebx
	call	DWORD PTR __imp__memmove
	mov	ecx, DWORD PTR tv268[esp+116]
	add	esp, 12					; 0000000cH
$LN20@M_fill_ins@5:

; 156  :     _STLP_STD::fill(__pos, __pos + __n, __x);

	lea	edx, DWORD PTR [ecx+edi]
	cmp	edi, edx
	mov	eax, edi
	je	SHORT $LN45@M_fill_ins@5
$LL24@M_fill_ins@5:
	mov	esi, DWORD PTR ___x$[esp+104]
	mov	edi, eax
	add	eax, 92					; 0000005cH
	cmp	eax, edx
	mov	ecx, 23					; 00000017H
	rep movsd
	jne	SHORT $LL24@M_fill_ins@5
	pop	ebx
	pop	edi
	pop	esi
	pop	ebp

; 162  :   }
; 163  : }

	add	esp, 92					; 0000005cH
	ret	16					; 00000010H
$LN2@M_fill_ins@5:

; 157  :   } else {
; 158  :     this->_M_finish = _STLP_PRIV __uninitialized_fill_n(this->_M_finish, __n - __elems_after, __x);

	sub	eax, esi
	imul	eax, 92					; 0000005cH
	add	eax, ebx
	push	ecx
	mov	ecx, ebx
	mov	DWORD PTR ___last$251572[esp+108], eax
	call	??$__ufill@PAUParticle@CEffect_Rain@@U12@H@priv@stlp_std@@YAXPAUParticle@CEffect_Rain@@0ABU23@ABUrandom_access_iterator_tag@1@PAH@Z ; stlp_std::priv::__ufill<CEffect_Rain::Particle *,CEffect_Rain::Particle,int>
	mov	eax, DWORD PTR ___last$251572[esp+108]
	add	esp, 4

; 159  :     _STLP_PRIV __ucopy_ptrs(__pos, __old_finish, this->_M_finish, _TrivialUCopy());

	cmp	ebx, edi
	mov	DWORD PTR [ebp+4], eax
	je	SHORT $LN34@M_fill_ins@5
	mov	edx, ebx
	sub	edx, edi
	push	edx
	push	edi
	push	eax
	call	_memcpy
	add	esp, 12					; 0000000cH
$LN34@M_fill_ins@5:

; 160  :     this->_M_finish += __elems_after;

	imul	esi, 92					; 0000005cH
	add	DWORD PTR [ebp+4], esi

; 161  :     _STLP_STD::fill(__pos, __old_finish, __x);

	cmp	edi, ebx
	mov	eax, edi
	je	SHORT $LN45@M_fill_ins@5
	npad	6
$LL37@M_fill_ins@5:
	mov	esi, DWORD PTR ___x$[esp+104]
	mov	edi, eax
	add	eax, 92					; 0000005cH
	cmp	eax, ebx
	mov	ecx, 23					; 00000017H
	rep movsd
	jne	SHORT $LL37@M_fill_ins@5
$LN45@M_fill_ins@5:
	pop	ebx
	pop	edi
	pop	esi
	pop	ebp

; 162  :   }
; 163  : }

	add	esp, 92					; 0000005cH
	ret	16					; 00000010H
?_M_fill_insert_aux@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@ABU__false_type@3@@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert_aux
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_algobase.h
_TEXT	ENDS
;	COMDAT ??$__copy_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z
_TEXT	SEGMENT
??$__copy_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z PROC ; stlp_std::priv::__copy_ptrs<CEffect_Rain::Particle *,CEffect_Rain::Particle *>, COMDAT
; ___first$ = edx
; ___last$ = ecx
; ___result$ = eax

; 255  :   // we know they all pointers, so this cast is OK
; 256  :   //  return (_OutputIter)__copy_trivial(&(*__first), &(*__last), &(*__result));
; 257  :   return (_OutputIter)__copy_trivial(__first, __last, __result);

	sub	ecx, edx
	push	esi
	mov	esi, ecx
	je	SHORT $LN6@copy_ptrs@17
	push	esi
	push	edx
	push	eax
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, esi
$LN6@copy_ptrs@17:
	pop	esi

; 258  : }

	ret	0
??$__copy_ptrs@PAUParticle@CEffect_Rain@@PAU12@@priv@stlp_std@@YAPAUParticle@CEffect_Rain@@PAU23@00ABU__true_type@1@@Z ENDP ; stlp_std::priv::__copy_ptrs<CEffect_Rain::Particle *,CEffect_Rain::Particle *>
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_vector.h
_TEXT	ENDS
;	COMDAT ?_M_erase@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEPAUParticle@CEffect_Rain@@PAU45@0ABU__false_type@3@@Z
_TEXT	SEGMENT
?_M_erase@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEPAUParticle@CEffect_Rain@@PAU45@0ABU__false_type@3@@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_erase, COMDAT
; _this$ = ebx
; ___first$ = edi
; ___last$ = eax

; 578  :   iterator _M_erase(iterator __first, iterator __last, const __false_type& /*_Movable*/) {

	push	esi

; 579  :     pointer __i = _STLP_PRIV __copy_ptrs(__last, this->_M_finish, __first, _TrivialCopy());

	mov	esi, DWORD PTR [ebx+4]
	sub	esi, eax
	je	SHORT $LN7@M_erase@14
	push	esi
	push	eax
	push	edi
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, esi

; 580  :     _STLP_STD::_Destroy_Range(__i, this->_M_finish);
; 581  :     this->_M_finish = __i;

	mov	DWORD PTR [ebx+4], eax

; 582  :     return __first;

	mov	eax, edi
	pop	esi

; 583  :   }

	ret	0

; 579  :     pointer __i = _STLP_PRIV __copy_ptrs(__last, this->_M_finish, __first, _TrivialCopy());

$LN7@M_erase@14:

; 580  :     _STLP_STD::_Destroy_Range(__i, this->_M_finish);
; 581  :     this->_M_finish = __i;

	mov	DWORD PTR [ebx+4], edi

; 582  :     return __first;

	mov	eax, edi
	pop	esi

; 583  :   }

	ret	0
?_M_erase@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEPAUParticle@CEffect_Rain@@PAU45@0ABU__false_type@3@@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_erase
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?erase@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEPAUParticle@CEffect_Rain@@PAU45@0@Z
_TEXT	SEGMENT
?erase@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEPAUParticle@CEffect_Rain@@PAU45@0@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::erase, COMDAT
; _this$ = ebx
; ___first$ = edi
; ___last$ = eax

; 590  :     if (__first == __last)

	cmp	edi, eax

; 591  :       return __first;

	je	SHORT $LN12@erase@17
	push	esi

; 592  :     return _M_erase(__first, __last, _Movable());

	mov	esi, DWORD PTR [ebx+4]
	sub	esi, eax
	je	SHORT $LN10@erase@17
	push	esi
	push	eax
	push	edi
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, esi
	mov	DWORD PTR [ebx+4], eax
	pop	esi
	mov	eax, edi

; 593  :   }

	ret	0

; 592  :     return _M_erase(__first, __last, _Movable());

$LN10@erase@17:
	mov	eax, edi
	mov	DWORD PTR [ebx+4], eax
	pop	esi
$LN12@erase@17:
	mov	eax, edi

; 593  :   }

	ret	0
?erase@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEPAUParticle@CEffect_Rain@@PAU45@0@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::erase
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?front@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEAAUParticle@CEffect_Rain@@XZ
_TEXT	SEGMENT
?front@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEAAUParticle@CEffect_Rain@@XZ PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::front, COMDAT
; _this$ = eax

; 193  :   reference front()             { return *begin(); }

	mov	eax, DWORD PTR [eax]
	ret	0
?front@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEAAUParticle@CEffect_Rain@@XZ ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::front
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\pointers\_vector.h
_TEXT	ENDS
;	COMDAT ?size@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QBEIXZ
_TEXT	SEGMENT
?size@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QBEIXZ PROC ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::size, COMDAT
; _this$ = eax

; 89   :   size_type size() const        { return _M_impl.size(); }

	mov	ecx, DWORD PTR [eax+4]
	sub	ecx, DWORD PTR [eax]
	mov	eax, -1307163959			; b21642c9H
	imul	ecx
	add	edx, ecx
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	add	eax, edx
	ret	0
?size@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QBEIXZ ENDP ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::size
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?begin@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEPAUParticle@CEffect_Rain@@XZ
_TEXT	SEGMENT
?begin@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEPAUParticle@CEffect_Rain@@XZ PROC ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::begin, COMDAT
; _this$ = eax

; 79   :   iterator begin()             { return cast_traits::to_value_type_ptr(_M_impl.begin()); }

	mov	eax, DWORD PTR [eax]
	ret	0
?begin@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEPAUParticle@CEffect_Rain@@XZ ENDP ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::begin
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?front@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEAAUParticle@CEffect_Rain@@XZ
_TEXT	SEGMENT
?front@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEAAUParticle@CEffect_Rain@@XZ PROC ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::front, COMDAT
; _this$ = eax

; 98   :   reference front()             { return cast_traits::to_value_type_ref(_M_impl.front()); }

	mov	eax, DWORD PTR [eax]
	ret	0
?front@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEAAUParticle@CEffect_Rain@@XZ ENDP ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::front
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrcore\_stl_extensions.h
_TEXT	ENDS
;	COMDAT ??A?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEAAUParticle@CEffect_Rain@@I@Z
_TEXT	SEGMENT
??A?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEAAUParticle@CEffect_Rain@@I@Z PROC ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::operator[], COMDAT
; _this$ = ecx
; __Pos$ = eax

; 139  : 	reference operator[]		(size_type _Pos)					{ {VERIFY2(_Pos<size(),make_string("index is out of range: index requested[%d], size of container[%d]", _Pos, size()).c_str());} return (*(begin() + _Pos)); }

	imul	eax, 92					; 0000005cH
	add	eax, DWORD PTR [ecx]
	ret	0
??A?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEAAUParticle@CEffect_Rain@@I@Z ENDP ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::operator[]
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?size@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QBEIXZ
_TEXT	SEGMENT
?size@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QBEIXZ PROC ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::size, COMDAT
; _this$ = eax

; 126  : 	u32		size				() const							{ return (u32)inherited::size();} 

	mov	ecx, DWORD PTR [eax+4]
	sub	ecx, DWORD PTR [eax]
	mov	eax, -1307163959			; b21642c9H
	imul	ecx
	add	edx, ecx
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	add	eax, edx
	ret	0
?size@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QBEIXZ ENDP ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::size
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\include\xrrender\factoryptr.h
_TEXT	ENDS
;	COMDAT ??0?$FactoryPtr@VIRainRender@@@@QAE@XZ
_TEXT	SEGMENT
??0?$FactoryPtr@VIRainRender@@@@QAE@XZ PROC		; FactoryPtr<IRainRender>::FactoryPtr<IRainRender>, COMDAT
; _this$ = esi

; 24   : 	FactoryPtr() { CreateObject();}

	mov	eax, DWORD PTR __imp_?RenderFactory@@3PAVIRenderFactory@@A
	mov	ecx, DWORD PTR [eax]
	mov	edx, DWORD PTR [ecx]
	mov	eax, DWORD PTR [edx+88]
	call	eax
	mov	DWORD PTR [esi], eax
	mov	eax, esi
	ret	0
??0?$FactoryPtr@VIRainRender@@@@QAE@XZ ENDP		; FactoryPtr<IRainRender>::FactoryPtr<IRainRender>
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrcore\_matrix.h
_TEXT	ENDS
;	COMDAT ?rotateY@?$_matrix@M@@QAEAAU1@M@Z
_TEXT	SEGMENT
_cosa$ = -4						; size = 4
_Angle$ = 8						; size = 4
?rotateY@?$_matrix@M@@QAEAAU1@M@Z PROC			; _matrix<float>::rotateY, COMDAT
; _this$ = esi

; 276  : 	{

	push	ecx

; 277  : 		T cosa	= _cos(Angle);

	fld	DWORD PTR _Angle$[esp]
	push	ecx
	fstp	DWORD PTR [esp]
	call	_cosf
	fstp	DWORD PTR _cosa$[esp+8]

; 278  : 		T sina	= _sin(Angle);

	fld	DWORD PTR _Angle$[esp+4]
	fstp	DWORD PTR [esp]
	call	_sinf

; 279  : 		i.set		(cosa,	0,	   -sina);	_14 = 0;

	xorps	xmm0, xmm0
	fld	DWORD PTR _cosa$[esp+8]

; 280  : 		j.set		(0,		1,		0	);	_24 = 0;

	movss	xmm1, DWORD PTR __real@3f800000
	fstp	DWORD PTR [esi]

; 281  : 		k.set		(sina,  0,		cosa);	_34 = 0;

	movss	xmm2, DWORD PTR _cosa$[esp+8]
	movss	DWORD PTR [esi+4], xmm0
	fld	ST(0)
	movss	DWORD PTR [esi+12], xmm0
	fchs
	fstp	DWORD PTR [esi+8]
	movss	DWORD PTR [esi+16], xmm0
	movss	DWORD PTR [esi+20], xmm1
	movss	DWORD PTR [esi+24], xmm0
	movss	DWORD PTR [esi+28], xmm0
	fstp	DWORD PTR [esi+32]
	movss	DWORD PTR [esi+36], xmm0
	movss	DWORD PTR [esi+40], xmm2
	movss	DWORD PTR [esi+44], xmm0

; 282  : 		c.set		(0,		0,		0	);	_44 = 1;

	movss	DWORD PTR [esi+48], xmm0
	movss	DWORD PTR [esi+52], xmm0
	movss	DWORD PTR [esi+56], xmm0
	movss	DWORD PTR [esi+60], xmm1

; 283  : 		return *this;

	mov	eax, esi

; 284  : 	}

	add	esp, 8
	ret	4
?rotateY@?$_matrix@M@@QAEAAU1@M@Z ENDP			; _matrix<float>::rotateY
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?translate_over@?$_matrix@M@@QAEAAU1@ABU?$_vector3@M@@@Z
_TEXT	SEGMENT
?translate_over@?$_matrix@M@@QAEAAU1@ABU?$_vector3@M@@@Z PROC ; _matrix<float>::translate_over, COMDAT
; _this$ = eax
; _Loc$ = ecx

; 244  : 		c.set	(Loc.x,Loc.y,Loc.z);				

	fld	DWORD PTR [ecx]
	movss	xmm0, DWORD PTR [ecx+4]
	movss	xmm1, DWORD PTR [ecx+8]
	fstp	DWORD PTR [eax+48]
	movss	DWORD PTR [eax+52], xmm0
	movss	DWORD PTR [eax+56], xmm1

; 245  : 		return *this;
; 246  : 	}

	ret	0
?translate_over@?$_matrix@M@@QAEAAU1@ABU?$_vector3@M@@@Z ENDP ; _matrix<float>::translate_over
_TEXT	ENDS
PUBLIC	?p_free@CEffect_Rain@@AAEXPAUParticle@1@@Z	; CEffect_Rain::p_free
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrengine\rain.cpp
;	COMDAT ?p_free@CEffect_Rain@@AAEXPAUParticle@1@@Z
_TEXT	SEGMENT
_P$ = 8							; size = 4
?p_free@CEffect_Rain@@AAEXPAUParticle@1@@Z PROC		; CEffect_Rain::p_free, COMDAT
; _this$ = ecx

; 484  : 	p_remove	(P,particle_active);

	mov	eax, DWORD PTR _P$[esp-4]
	mov	edx, DWORD PTR [eax+4]
	test	edx, edx
	push	esi
	mov	esi, DWORD PTR [eax]
	mov	DWORD PTR [eax+4], 0
	mov	DWORD PTR [eax], 0
	je	SHORT $LN5@p_free
	mov	DWORD PTR [edx], esi
$LN5@p_free:
	test	esi, esi
	je	SHORT $LN4@p_free
	mov	DWORD PTR [esi+4], edx
$LN4@p_free:
	cmp	DWORD PTR [ecx+32], eax
	jne	SHORT $LN3@p_free
	mov	DWORD PTR [ecx+32], esi
$LN3@p_free:

; 485  : 	p_insert	(P,particle_idle);

	mov	DWORD PTR [eax+4], 0
	mov	edx, DWORD PTR [ecx+36]
	mov	DWORD PTR [eax], edx
	mov	edx, DWORD PTR [ecx+36]
	test	edx, edx
	pop	esi
	je	SHORT $LN17@p_free
	mov	DWORD PTR [edx+4], eax
$LN17@p_free:
	mov	DWORD PTR [ecx+36], eax

; 486  : }

	ret	4
?p_free@CEffect_Rain@@AAEXPAUParticle@1@@Z ENDP		; CEffect_Rain::p_free
_TEXT	ENDS
PUBLIC	?p_allocate@CEffect_Rain@@AAEPAUParticle@1@XZ	; CEffect_Rain::p_allocate
; Function compile flags: /Ogtpy
;	COMDAT ?p_allocate@CEffect_Rain@@AAEPAUParticle@1@XZ
_TEXT	SEGMENT
?p_allocate@CEffect_Rain@@AAEPAUParticle@1@XZ PROC	; CEffect_Rain::p_allocate, COMDAT
; _this$ = ecx

; 474  : 	Particle*	P			= particle_idle;

	mov	eax, DWORD PTR [ecx+36]

; 475  : 	if (0==P)				return NULL;

	test	eax, eax
	jne	SHORT $LN1@p_allocate

; 478  : 	return		P;
; 479  : }

	ret	0
$LN1@p_allocate:

; 476  : 	p_remove	(P,particle_idle);

	mov	edx, DWORD PTR [eax+4]
	test	edx, edx
	push	esi
	mov	esi, DWORD PTR [eax]
	mov	DWORD PTR [eax+4], 0
	mov	DWORD PTR [eax], 0
	je	SHORT $LN6@p_allocate
	mov	DWORD PTR [edx], esi
$LN6@p_allocate:
	test	esi, esi
	je	SHORT $LN5@p_allocate
	mov	DWORD PTR [esi+4], edx
$LN5@p_allocate:
	cmp	DWORD PTR [ecx+36], eax
	jne	SHORT $LN4@p_allocate
	mov	DWORD PTR [ecx+36], esi
$LN4@p_allocate:

; 477  : 	p_insert	(P,particle_active);

	mov	DWORD PTR [eax+4], 0
	mov	edx, DWORD PTR [ecx+32]
	mov	DWORD PTR [eax], edx
	mov	edx, DWORD PTR [ecx+32]
	test	edx, edx
	pop	esi
	je	SHORT $LN12@p_allocate
	mov	DWORD PTR [edx+4], eax
$LN12@p_allocate:
	mov	DWORD PTR [ecx+32], eax

; 478  : 	return		P;
; 479  : }

	ret	0
?p_allocate@CEffect_Rain@@AAEPAUParticle@1@XZ ENDP	; CEffect_Rain::p_allocate
_TEXT	ENDS
PUBLIC	?RayPick@CEffect_Rain@@AAEHABU?$_vector3@M@@0AAMW4rq_target@collide@@@Z ; CEffect_Rain::RayPick
; Function compile flags: /Ogtpy
;	COMDAT ?RayPick@CEffect_Rain@@AAEHABU?$_vector3@M@@0AAMW4rq_target@collide@@@Z
_TEXT	SEGMENT
_RQ$ = -12						; size = 12
_s$ = 8							; size = 4
_d$ = 12						; size = 4
_range$ = 16						; size = 4
_tgt$ = 20						; size = 4
?RayPick@CEffect_Rain@@AAEHABU?$_vector3@M@@0AAMW4rq_target@collide@@@Z PROC ; CEffect_Rain::RayPick, COMDAT
; _this$ = ecx

; 97   : 	BOOL bRes 			= TRUE;
; 98   : #ifdef _EDITOR
; 99   :     Tools->RayPick		(s,d,range);
; 100  : #else
; 101  : 	collide::rq_result	RQ;
; 102  : 	CObject* E 			= g_pGameLevel->CurrentViewEntity();

	mov	eax, DWORD PTR ?g_pGameLevel@@3PAVIGame_Level@@A ; g_pGameLevel
	mov	ecx, DWORD PTR [eax+36]

; 103  : 	bRes 				= g_pGameLevel->ObjectSpace.RayPick( s,d,range,tgt,RQ,E);	

	mov	edx, DWORD PTR _tgt$[esp-4]
	sub	esp, 12					; 0000000cH
	push	esi
	mov	esi, DWORD PTR _range$[esp+12]
	fld	DWORD PTR [esi]
	push	ecx
	lea	ecx, DWORD PTR _RQ$[esp+20]
	push	ecx
	push	edx
	mov	edx, DWORD PTR _s$[esp+24]
	push	ecx
	mov	ecx, DWORD PTR _d$[esp+28]
	fstp	DWORD PTR [esp]
	push	ecx
	push	edx
	lea	ecx, DWORD PTR [eax+262292]
	call	DWORD PTR __imp_?RayPick@CObjectSpace@@QAEHABU?$_vector3@M@@0MW4rq_target@collide@@AAUrq_result@4@PAVCObject@@@Z

; 104  :     if (bRes) range 	= RQ.range;

	test	eax, eax
	je	SHORT $LN1@RayPick
	movss	xmm0, DWORD PTR _RQ$[esp+20]
	movss	DWORD PTR [esi], xmm0
$LN1@RayPick:
	pop	esi

; 105  : #endif
; 106  :     return bRes;
; 107  : }

	add	esp, 12					; 0000000cH
	ret	16					; 00000010H
?RayPick@CEffect_Rain@@AAEHABU?$_vector3@M@@0AAMW4rq_target@collide@@@Z ENDP ; CEffect_Rain::RayPick
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrsound\sound.h
;	COMDAT ?set_position@ref_sound@@QAEXABU?$_vector3@M@@@Z
_TEXT	SEGMENT
_pos$ = 8						; size = 4
?set_position@ref_sound@@QAEXABU?$_vector3@M@@@Z PROC	; ref_sound::set_position, COMDAT
; _this$ = eax

; 308  : IC void	ref_sound::set_position					( const Fvector &pos)									{	VERIFY(!::Sound->i_locked()); 	VERIFY(_feedback());_feedback()->set_position(pos);								}

	mov	eax, DWORD PTR [eax]
	mov	ecx, eax
	neg	ecx
	sbb	ecx, ecx
	test	ecx, OFFSET ?_get@?$resptr_base@Vref_sound_data@@@@QBEPAVref_sound_data@@XZ ; resptr_base<ref_sound_data>::_get
	je	SHORT $LN11@set_positi
	mov	eax, DWORD PTR [eax+12]
	jmp	SHORT $LN12@set_positi
$LN11@set_positi:
	xor	eax, eax
$LN12@set_positi:
	mov	edx, DWORD PTR [eax]
	mov	edx, DWORD PTR [edx+12]
	mov	ecx, eax
	jmp	edx
?set_position@ref_sound@@QAEXABU?$_vector3@M@@@Z ENDP	; ref_sound::set_position
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?stop@ref_sound@@QAEXXZ
_TEXT	SEGMENT
?stop@ref_sound@@QAEXXZ PROC				; ref_sound::stop, COMDAT
; _this$ = eax

; 313  : IC void	ref_sound::stop							( )														{	VERIFY(!::Sound->i_locked()); 	if (_feedback())	_feedback()->stop(FALSE);									}

	mov	eax, DWORD PTR [eax]
	mov	ecx, eax
	neg	ecx
	sbb	ecx, ecx
	test	ecx, OFFSET ?_get@?$resptr_base@Vref_sound_data@@@@QBEPAVref_sound_data@@XZ ; resptr_base<ref_sound_data>::_get
	je	SHORT $LN1@stop
	mov	ecx, DWORD PTR [eax+12]
	test	ecx, ecx
	je	SHORT $LN1@stop
	mov	edx, DWORD PTR [ecx]
	mov	eax, DWORD PTR [edx+32]
	push	0
	call	eax
$LN1@stop:
	ret	0
?stop@ref_sound@@QAEXXZ ENDP				; ref_sound::stop
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_vector.h
_TEXT	ENDS
;	COMDAT ??0?$_Vector_base@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z
_TEXT	SEGMENT
??0?$_Vector_base@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z PROC ; stlp_std::priv::_Vector_base<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_Vector_base<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >, COMDAT
; _this$ = eax

; 67   :     : _M_start(0), _M_finish(0), _M_end_of_storage(__a, 0) {}

	xor	ecx, ecx
	mov	DWORD PTR [eax], ecx
	mov	DWORD PTR [eax+4], ecx
	mov	DWORD PTR [eax+8], ecx
	ret	0
??0?$_Vector_base@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z ENDP ; stlp_std::priv::_Vector_base<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_Vector_base<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?clear@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXXZ
_TEXT	SEGMENT
?clear@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXXZ PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear, COMDAT
; _this$ = edi

; 611  :     erase(begin(), end());

	mov	ecx, DWORD PTR [edi+4]
	mov	eax, DWORD PTR [edi]
	cmp	eax, ecx
	je	SHORT $LN10@clear@26
	push	esi
	mov	esi, ecx
	sub	esi, ecx
	je	SHORT $LN16@clear@26
	push	esi
	push	ecx
	push	eax
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, esi
$LN16@clear@26:
	mov	DWORD PTR [edi+4], eax
	pop	esi
$LN10@clear@26:

; 612  :   }

	ret	0
?clear@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXXZ ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??0?$_Vector_base@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z
_TEXT	SEGMENT
??0?$_Vector_base@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z PROC ; stlp_std::priv::_Vector_base<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::_Vector_base<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >, COMDAT
; _this$ = eax

; 67   :     : _M_start(0), _M_finish(0), _M_end_of_storage(__a, 0) {}

	xor	ecx, ecx
	mov	DWORD PTR [eax], ecx
	mov	DWORD PTR [eax+4], ecx
	mov	DWORD PTR [eax+8], ecx
	ret	0
??0?$_Vector_base@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z ENDP ; stlp_std::priv::_Vector_base<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::_Vector_base<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??0?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z
_TEXT	SEGMENT
??0?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >, COMDAT
; _this$ = eax

; 208  :     : _STLP_PRIV _Vector_base<_Tp, _Alloc>(__a) {}

	xor	ecx, ecx
	mov	DWORD PTR [eax], ecx
	mov	DWORD PTR [eax+4], ecx
	mov	DWORD PTR [eax+8], ecx
	ret	0
??0?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\pointers\_vector.h
_TEXT	ENDS
;	COMDAT ?clear@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEXXZ
_TEXT	SEGMENT
?clear@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEXXZ PROC ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear, COMDAT
; _this$ = edi

; 223  :   void clear() { _M_impl.clear(); }

	mov	ecx, DWORD PTR [edi+4]
	mov	eax, DWORD PTR [edi]
	cmp	eax, ecx
	je	SHORT $LN12@clear@27
	push	esi
	mov	esi, ecx
	sub	esi, ecx
	je	SHORT $LN18@clear@27
	push	esi
	push	ecx
	push	eax
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, esi
$LN18@clear@27:
	mov	DWORD PTR [edi+4], eax
	pop	esi
$LN12@clear@27:
	ret	0
?clear@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEXXZ ENDP ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_vector.h
_TEXT	ENDS
;	COMDAT ??0?$_Impl_vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z
_TEXT	SEGMENT
??0?$_Impl_vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::_Impl_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >, COMDAT
; _this$ = eax

; 208  :     : _STLP_PRIV _Vector_base<_Tp, _Alloc>(__a) {}

	xor	ecx, ecx
	mov	DWORD PTR [eax], ecx
	mov	DWORD PTR [eax+4], ecx
	mov	DWORD PTR [eax+8], ecx
	ret	0
??0?$_Impl_vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@priv@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::_Impl_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\pointers\_vector.h
_TEXT	ENDS
;	COMDAT ??0?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z
_TEXT	SEGMENT
??0?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z PROC ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >, COMDAT
; _this$ = eax

; 106  :   explicit vector(const allocator_type& __a = allocator_type())

	xor	ecx, ecx
	mov	DWORD PTR [eax], ecx
	mov	DWORD PTR [eax+4], ecx
	mov	DWORD PTR [eax+8], ecx
	ret	0
??0?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAE@ABV?$xalloc@UParticle@CEffect_Rain@@@@@Z ENDP ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrcore\_stl_extensions.h
_TEXT	ENDS
;	COMDAT ?clear_and_free@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEXXZ
_TEXT	SEGMENT
?clear_and_free@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEXXZ PROC ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear_and_free, COMDAT
; _this$ = edi

; 128  : 	void	clear_and_free		()									{ inherited::clear();			}

	mov	ecx, DWORD PTR [edi+4]
	mov	eax, DWORD PTR [edi]
	cmp	eax, ecx
	je	SHORT $LN14@clear_and_@8
	push	esi
	mov	esi, ecx
	sub	esi, ecx
	je	SHORT $LN20@clear_and_@8
	push	esi
	push	ecx
	push	eax
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, esi
$LN20@clear_and_@8:
	mov	DWORD PTR [edi+4], eax
	pop	esi
$LN14@clear_and_@8:
	ret	0
?clear_and_free@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEXXZ ENDP ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear_and_free
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\pointers\_vector.h
_TEXT	ENDS
;	COMDAT ??0?$vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z
_TEXT	SEGMENT
??0?$vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z PROC ; stlp_std::vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >, COMDAT
; _this$ = eax

; 106  :   explicit vector(const allocator_type& __a = allocator_type())

	xor	ecx, ecx
	mov	DWORD PTR [eax], ecx
	mov	DWORD PTR [eax+4], ecx
	mov	DWORD PTR [eax+8], ecx
	ret	0
??0?$vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@stlp_std@@QAE@ABV?$xalloc@UItem@CEffect_Rain@@@@@Z ENDP ; stlp_std::vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrcore\_stl_extensions.h
_TEXT	ENDS
;	COMDAT ?clear@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEXXZ
_TEXT	SEGMENT
?clear@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEXXZ PROC ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear, COMDAT
; _this$ = edi

; 133  : 	void	clear				()									{ clear_and_free	();			}

	mov	ecx, DWORD PTR [edi+4]
	mov	eax, DWORD PTR [edi]
	cmp	eax, ecx
	je	SHORT $LN16@clear@28
	push	esi
	mov	esi, ecx
	sub	esi, ecx
	je	SHORT $LN22@clear@28
	push	esi
	push	ecx
	push	eax
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, esi
$LN22@clear@28:
	mov	DWORD PTR [edi+4], eax
	pop	esi
$LN16@clear@28:
	ret	0
?clear@?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAEXXZ ENDP ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::clear
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??0?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAE@XZ
_TEXT	SEGMENT
??0?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAE@XZ PROC ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >, COMDAT
; _this$ = eax

; 123  : 			xr_vector			()									: inherited	()					{}

	xor	ecx, ecx
	mov	DWORD PTR [eax], ecx
	mov	DWORD PTR [eax+4], ecx
	mov	DWORD PTR [eax+8], ecx
	ret	0
??0?$xr_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@@QAE@XZ ENDP ; xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::xr_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??0?$xr_vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@@QAE@XZ
_TEXT	SEGMENT
??0?$xr_vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@@QAE@XZ PROC ; xr_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::xr_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >, COMDAT
; _this$ = eax

; 123  : 			xr_vector			()									: inherited	()					{}

	xor	ecx, ecx
	mov	DWORD PTR [eax], ecx
	mov	DWORD PTR [eax+4], ecx
	mov	DWORD PTR [eax+8], ecx
	ret	0
??0?$xr_vector@UItem@CEffect_Rain@@V?$xalloc@UItem@CEffect_Rain@@@@@@QAE@XZ ENDP ; xr_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >::xr_vector<CEffect_Rain::Item,xalloc<CEffect_Rain::Item> >
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrcore\_vector3d.h
_TEXT	ENDS
;	COMDAT ?random_dir@?$_vector3@M@@QAEAAU1@ABU1@MAAVCRandom@@@Z
_TEXT	SEGMENT
tv189 = -16						; size = 4
_rnd$ = -12						; size = 12
tv217 = 8						; size = 4
_mag$312148 = 8						; size = 4
$T312138 = 8						; size = 4
_ConeAxis$ = 8						; size = 4
tv192 = 12						; size = 4
_ConeAngle$ = 12					; size = 4
?random_dir@?$_vector3@M@@QAEAAU1@ABU1@MAAVCRandom@@@Z PROC ; _vector3<float>::random_dir, COMDAT
; _this$ = ebx
; _R$ = eax

; 245  : 	{

	sub	esp, 16					; 00000010H
	push	ebp
	mov	ebp, DWORD PTR _ConeAxis$[esp+16]
	push	esi
	push	edi
	mov	edi, eax

; 246  : 		Self				rnd;
; 247  : 		rnd.random_dir		(R);

	lea	esi, DWORD PTR _rnd$[esp+28]
	call	?random_dir@?$_vector3@M@@QAEAAU1@AAVCRandom@@@Z ; _vector3<float>::random_dir

; 248  : 		mad					(ConeAxis,rnd,R.randF(tanf(ConeAngle)));

	mov	eax, edi
	call	?randI@CRandom@@QAEHXZ			; CRandom::randI
	mov	DWORD PTR tv217[esp+24], eax
	fild	DWORD PTR tv217[esp+24]
	movss	xmm0, DWORD PTR _rnd$[esp+36]
	fld	DWORD PTR _ConeAngle$[esp+24]

; 249  : 		normalize			();

	push	ecx
	fptan
	fstp	ST(0)
	fmulp	ST(1), ST(0)
	fmul	DWORD PTR __real@38000100
	fst	DWORD PTR $T312138[esp+28]
	fld	DWORD PTR _rnd$[esp+32]
	mulss	xmm0, DWORD PTR $T312138[esp+28]
	fmul	ST(0), ST(1)
	fadd	DWORD PTR [ebp]
	fstp	DWORD PTR [ebx]
	movss	xmm2, DWORD PTR [ebx]
	movaps	xmm3, xmm2
	fmul	DWORD PTR _rnd$[esp+36]
	mulss	xmm3, xmm2
	movss	DWORD PTR tv192[esp+28], xmm2
	fadd	DWORD PTR [ebp+4]
	fstp	DWORD PTR [ebx+4]
	movss	xmm1, DWORD PTR [ebx+4]
	addss	xmm0, DWORD PTR [ebp+8]
	movaps	xmm2, xmm1
	mulss	xmm2, xmm1
	movss	DWORD PTR tv189[esp+32], xmm1
	movaps	xmm1, xmm0
	mulss	xmm1, xmm0
	movss	DWORD PTR [ebx+8], xmm0
	movss	xmm0, DWORD PTR __real@3f800000
	addss	xmm3, xmm2
	addss	xmm3, xmm1
	divss	xmm0, xmm3
	movss	DWORD PTR [esp], xmm0
	call	_sqrtf
	fst	DWORD PTR _mag$312148[esp+28]
	movss	xmm1, DWORD PTR _mag$312148[esp+28]
	fmul	DWORD PTR [ebx+8]
	movss	xmm0, DWORD PTR tv192[esp+28]
	add	esp, 4
	mulss	xmm0, xmm1
	fstp	DWORD PTR [ebx+8]
	pop	edi
	movss	DWORD PTR [ebx], xmm0
	movss	xmm0, DWORD PTR tv189[esp+24]
	pop	esi
	mulss	xmm0, xmm1
	movss	DWORD PTR [ebx+4], xmm0

; 250  : 		return *this;	

	mov	eax, ebx
	pop	ebp

; 251  : 	}	

	add	esp, 16					; 00000010H
	ret	8
?random_dir@?$_vector3@M@@QAEAAU1@ABU1@MAAVCRandom@@@Z ENDP ; _vector3<float>::random_dir
_TEXT	ENDS
PUBLIC	?p_destroy@CEffect_Rain@@AAEXXZ			; CEffect_Rain::p_destroy
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrengine\rain.cpp
;	COMDAT ?p_destroy@CEffect_Rain@@AAEXXZ
_TEXT	SEGMENT
?p_destroy@CEffect_Rain@@AAEXXZ PROC			; CEffect_Rain::p_destroy, COMDAT
; _this$ = ecx

; 430  : 	// active and idle lists
; 431  : 	particle_active	= 0;

	xor	eax, eax
	push	esi
	mov	esi, ecx
	mov	DWORD PTR [esi+32], eax

; 432  : 	particle_idle	= 0;

	mov	DWORD PTR [esi+36], eax

; 433  : 	
; 434  : 	// pool
; 435  : 	particle_pool.clear	();

	mov	ecx, DWORD PTR [esi+24]
	mov	eax, DWORD PTR [esi+20]
	cmp	eax, ecx
	je	SHORT $LN18@p_destroy
	push	edi
	mov	edi, ecx
	sub	edi, ecx
	je	SHORT $LN24@p_destroy
	push	edi
	push	ecx
	push	eax
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, edi
$LN24@p_destroy:
	mov	DWORD PTR [esi+24], eax
	pop	edi
$LN18@p_destroy:
	pop	esi

; 436  : }

	ret	0
?p_destroy@CEffect_Rain@@AAEXXZ ENDP			; CEffect_Rain::p_destroy
_TEXT	ENDS
PUBLIC	?Hit@CEffect_Rain@@AAEXAAU?$_vector3@M@@@Z	; CEffect_Rain::Hit
; Function compile flags: /Ogtpy
;	COMDAT ?Hit@CEffect_Rain@@AAEXAAU?$_vector3@M@@@Z
_TEXT	SEGMENT
_pos$ = 8						; size = 4
?Hit@CEffect_Rain@@AAEXAAU?$_vector3@M@@@Z PROC		; CEffect_Rain::Hit, COMDAT
; _this$ = ecx

; 396  : 	if (0!=::Random.randI(2))	return;

	mov	eax, DWORD PTR __imp_?Random@@3VCRandom@@A
	push	esi
	mov	esi, ecx
	call	?randI@CRandom@@QAEHXZ			; CRandom::randI
	and	eax, -2147483647			; 80000001H
	jns	SHORT $LN25@Hit
	dec	eax
	or	eax, -2					; fffffffeH
	inc	eax
$LN25@Hit:
	jne	$LN3@Hit
	push	ebx

; 397  : 	Particle*	P	= p_allocate();

	mov	ecx, esi
	call	?p_allocate@CEffect_Rain@@AAEPAUParticle@1@XZ ; CEffect_Rain::p_allocate
	mov	ebx, eax

; 398  : 	if (0==P)	return;

	test	ebx, ebx
	je	$LN24@Hit

; 399  : 
; 400  : 	const Fsphere &bv_sphere = m_pRender->GetDropBounds();

	mov	ecx, DWORD PTR [esi]
	mov	eax, DWORD PTR [ecx]
	mov	edx, DWORD PTR [eax+12]
	push	edi
	call	edx

; 401  : 
; 402  : 	P->time						= particles_time;

	movss	xmm0, DWORD PTR _particles_time
	mov	edi, eax
	movss	DWORD PTR [ebx+88], xmm0

; 403  : 	P->mXForm.rotateY			(::Random.randF(PI_MUL_2));

	mov	eax, DWORD PTR __imp_?Random@@3VCRandom@@A
	lea	esi, DWORD PTR [ebx+8]
	call	?randI@CRandom@@QAEHXZ			; CRandom::randI
	cvtsi2ss xmm0, eax
	mulss	xmm0, DWORD PTR __real@3949116d
	push	ecx
	movss	DWORD PTR [esp], xmm0
	call	?rotateY@?$_matrix@M@@QAEAAU1@M@Z	; _matrix<float>::rotateY

; 404  : 	P->mXForm.translate_over	(pos);

	mov	eax, DWORD PTR _pos$[esp+8]
	movss	xmm0, DWORD PTR [eax+4]
	fld	DWORD PTR [eax]
	movss	xmm1, DWORD PTR [eax+8]
	fstp	DWORD PTR [ebx+56]
	movss	DWORD PTR [ebx+60], xmm0
	movss	DWORD PTR [ebx+64], xmm1

; 405  : 	P->mXForm.transform_tiny	(P->bounds.P, bv_sphere.P);

	movss	xmm0, DWORD PTR [esi+32]
	mulss	xmm0, DWORD PTR [edi+8]
	movss	xmm1, DWORD PTR [esi+16]
	mulss	xmm1, DWORD PTR [edi+4]
	addss	xmm0, xmm1
	movss	xmm1, DWORD PTR [edi]
	mulss	xmm1, DWORD PTR [esi]
	addss	xmm0, xmm1
	addss	xmm0, DWORD PTR [esi+48]
	movss	DWORD PTR [ebx+72], xmm0
	movss	xmm0, DWORD PTR [esi+36]
	mulss	xmm0, DWORD PTR [edi+8]
	movss	xmm1, DWORD PTR [esi+20]
	mulss	xmm1, DWORD PTR [edi+4]
	addss	xmm0, xmm1
	movss	xmm1, DWORD PTR [esi+4]
	mulss	xmm1, DWORD PTR [edi]
	addss	xmm0, xmm1
	addss	xmm0, DWORD PTR [esi+52]
	movss	DWORD PTR [ebx+76], xmm0
	movss	xmm0, DWORD PTR [esi+40]
	mulss	xmm0, DWORD PTR [edi+8]
	movss	xmm1, DWORD PTR [esi+24]
	mulss	xmm1, DWORD PTR [edi+4]
	addss	xmm0, xmm1
	movss	xmm1, DWORD PTR [esi+8]
	mulss	xmm1, DWORD PTR [edi]
	addss	xmm0, xmm1
	addss	xmm0, DWORD PTR [esi+56]
	movss	DWORD PTR [ebx+80], xmm0

; 406  : 	P->bounds.R					= bv_sphere.R;

	fld	DWORD PTR [edi+12]
	fstp	DWORD PTR [ebx+84]
	pop	edi
$LN24@Hit:
	pop	ebx
$LN3@Hit:
	pop	esi

; 407  : 
; 408  : }

	ret	4
?Hit@CEffect_Rain@@AAEXAAU?$_vector3@M@@@Z ENDP		; CEffect_Rain::Hit
_TEXT	ENDS
PUBLIC	__real@44fa0000
PUBLIC	?RenewItem@CEffect_Rain@@AAEXAAUItem@1@MH@Z	; CEffect_Rain::RenewItem
;	COMDAT __real@44fa0000
; File d:\clearsky\sources\engine\xrcore\_vector3d.h
CONST	SEGMENT
__real@44fa0000 DD 044fa0000r			; 2000
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrengine\rain.cpp
CONST	ENDS
;	COMDAT ?RenewItem@CEffect_Rain@@AAEXAAUItem@1@MH@Z
_TEXT	SEGMENT
_dest$ = 8						; size = 4
_a$312403 = 12						; size = 4
_a$312395 = 12						; size = 4
_a$312382 = 12						; size = 4
_a$312374 = 12						; size = 4
_height$ = 12						; size = 4
_bHit$ = 16						; size = 4
?RenewItem@CEffect_Rain@@AAEXAAUItem@1@MH@Z PROC	; CEffect_Rain::RenewItem, COMDAT
; _this$ = ecx

; 111  : 	dest.uv_set			= Random.randI(2);

	mov	eax, DWORD PTR __imp_?Random@@3VCRandom@@A
	push	esi
	push	edi
	call	?randI@CRandom@@QAEHXZ			; CRandom::randI
	mov	ecx, eax
	and	ecx, -2147483647			; 80000001H
	jns	SHORT $LN22@RenewItem
	dec	ecx
	or	ecx, -2					; fffffffeH
	inc	ecx
$LN22@RenewItem:

; 112  :     if (bHit){

	cmp	DWORD PTR _bHit$[esp+4], 0
	mov	eax, DWORD PTR _dest$[esp+4]

; 113  : 		dest.dwTime_Life= Device.dwTimeGlobal + iFloor(1000.f*height/dest.fSpeed) - Device.dwTimeDelta;

	movss	xmm1, DWORD PTR _height$[esp+4]
	mov	DWORD PTR [eax+48], ecx
	mov	ecx, 158				; 0000009eH
	mov	esi, 1
	je	$LN2@RenewItem
	movaps	xmm0, xmm1
	divss	xmm0, DWORD PTR [eax+36]
	mulss	xmm0, DWORD PTR _fuzzy_update_novis
	movss	DWORD PTR _a$312374[esp+4], xmm0
	mov	edi, DWORD PTR _a$312374[esp+4]
	mov	edx, edi
	sar	edx, 23					; 00000017H
	and	edx, 255				; 000000ffH
	sub	ecx, edx
	mov	edx, edi
	or	edx, -8388608				; ff800000H
	shl	edx, 8
	shr	edx, cl
	sub	ecx, 96					; 00000060H
	shl	esi, cl

; 114  : 		dest.dwTime_Hit	= Device.dwTimeGlobal + iFloor(1000.f*height/dest.fSpeed) - Device.dwTimeDelta;

	movss	DWORD PTR _a$312382[esp+4], xmm0
	sub	esi, 1
	sar	esi, 8
	and	esi, edi
	neg	esi
	sbb	esi, esi
	add	esi, 1
	sar	edi, 31					; 0000001fH
	and	esi, edi
	sub	edx, esi
	add	ecx, 64					; 00000040H
	sar	ecx, 31					; 0000001fH
	and	edx, ecx
	xor	edx, edi
	sub	edx, DWORD PTR ?Device@@3VCRenderDevice@@A+36
	mov	edi, DWORD PTR _a$312382[esp+4]
	add	edx, DWORD PTR ?Device@@3VCRenderDevice@@A+40
	mov	ecx, 158				; 0000009eH
	mov	DWORD PTR [eax+40], edx
	mov	edx, edi
	sar	edx, 23					; 00000017H
	and	edx, 255				; 000000ffH
	sub	ecx, edx
	mov	edx, edi
	or	edx, -8388608				; ff800000H
	shl	edx, 8
	shr	edx, cl
	sub	ecx, 96					; 00000060H
	mov	esi, 1
	shl	esi, cl
	sub	esi, 1
	sar	esi, 8
	and	esi, edi
	neg	esi
	sbb	esi, esi
	sar	edi, 31					; 0000001fH
	add	esi, 1
	and	esi, edi
	sub	edx, esi
	add	ecx, 64					; 00000040H
	sar	ecx, 31					; 0000001fH
	and	edx, ecx
	xor	edx, edi
	sub	edx, DWORD PTR ?Device@@3VCRenderDevice@@A+36
	pop	edi
	add	edx, DWORD PTR ?Device@@3VCRenderDevice@@A+40
	pop	esi
	mov	DWORD PTR [eax+44], edx

; 115  : 		dest.Phit.mad	(dest.P,dest.D,height);

	movss	xmm0, DWORD PTR [eax+24]
	mulss	xmm0, xmm1
	addss	xmm0, DWORD PTR [eax]
	movss	DWORD PTR [eax+12], xmm0
	movss	xmm0, DWORD PTR [eax+28]
	mulss	xmm0, xmm1
	addss	xmm0, DWORD PTR [eax+4]
	movss	DWORD PTR [eax+16], xmm0
	movss	xmm0, DWORD PTR [eax+32]
	mulss	xmm0, xmm1
	addss	xmm0, DWORD PTR [eax+8]
	movss	DWORD PTR [eax+20], xmm0

; 120  : 	}
; 121  : }

	ret	12					; 0000000cH
$LN2@RenewItem:

; 116  : 	}else{
; 117  : 		dest.dwTime_Life= Device.dwTimeGlobal + iFloor(1000.f*height/dest.fSpeed) - Device.dwTimeDelta;

	movss	xmm0, DWORD PTR __real@3f800000

; 118  : 		dest.dwTime_Hit	= Device.dwTimeGlobal + iFloor(2*1000.f*height/dest.fSpeed)-Device.dwTimeDelta;
; 119  : 		dest.Phit.set	(dest.P);

	fld	DWORD PTR [eax]
	divss	xmm0, DWORD PTR [eax+36]
	movaps	xmm2, xmm0
	mulss	xmm2, xmm1
	mulss	xmm2, DWORD PTR _fuzzy_update_novis
	movss	DWORD PTR _a$312395[esp+4], xmm2
	mov	edi, DWORD PTR _a$312395[esp+4]
	mov	edx, edi
	sar	edx, 23					; 00000017H
	and	edx, 255				; 000000ffH
	sub	ecx, edx
	mov	edx, edi
	or	edx, -8388608				; ff800000H
	shl	edx, 8
	shr	edx, cl
	sub	ecx, 96					; 00000060H
	shl	esi, cl
	mulss	xmm0, xmm1
	mulss	xmm0, DWORD PTR __real@44fa0000
	movss	DWORD PTR _a$312403[esp+4], xmm0
	sub	esi, 1
	sar	esi, 8
	and	esi, edi
	neg	esi
	sbb	esi, esi
	add	esi, 1
	sar	edi, 31					; 0000001fH
	and	esi, edi
	sub	edx, esi
	add	ecx, 64					; 00000040H
	sar	ecx, 31					; 0000001fH
	and	edx, ecx
	xor	edx, edi
	sub	edx, DWORD PTR ?Device@@3VCRenderDevice@@A+36
	mov	edi, DWORD PTR _a$312403[esp+4]
	add	edx, DWORD PTR ?Device@@3VCRenderDevice@@A+40
	mov	ecx, 158				; 0000009eH
	mov	DWORD PTR [eax+40], edx
	mov	edx, edi
	sar	edx, 23					; 00000017H
	and	edx, 255				; 000000ffH
	sub	ecx, edx
	mov	edx, edi
	or	edx, -8388608				; ff800000H
	shl	edx, 8
	shr	edx, cl
	sub	ecx, 96					; 00000060H
	mov	esi, 1
	shl	esi, cl
	sub	esi, 1
	sar	esi, 8
	and	esi, edi
	neg	esi
	sbb	esi, esi
	sar	edi, 31					; 0000001fH
	add	esi, 1
	and	esi, edi
	sub	edx, esi
	add	ecx, 64					; 00000040H
	sar	ecx, 31					; 0000001fH
	and	edx, ecx
	xor	edx, edi
	sub	edx, DWORD PTR ?Device@@3VCRenderDevice@@A+36
	pop	edi
	add	edx, DWORD PTR ?Device@@3VCRenderDevice@@A+40
	pop	esi
	mov	DWORD PTR [eax+44], edx
	fstp	DWORD PTR [eax+12]
	fld	DWORD PTR [eax+4]
	fstp	DWORD PTR [eax+16]
	fld	DWORD PTR [eax+8]
	fstp	DWORD PTR [eax+20]

; 120  : 	}
; 121  : }

	ret	12					; 0000000cH
?RenewItem@CEffect_Rain@@AAEXAAUItem@1@MH@Z ENDP	; CEffect_Rain::RenewItem
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_vector.c
;	COMDAT ?_M_insert_overflow@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@ABU45@ABU__true_type@3@I_N@Z
_TEXT	SEGMENT
___new_start$ = -4					; size = 4
___old_size$ = 8					; size = 4
_this$ = 8						; size = 4
___pos$ = 12						; size = 4
___x$ = 16						; size = 4
___fill_len$ = 20					; size = 4
?_M_insert_overflow@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@ABU45@ABU__true_type@3@I_N@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_insert_overflow, COMDAT

; 109  :                                              size_type __fill_len, bool __atend ) {

	push	ecx
	push	ebx
	push	ebp
	mov	ebp, DWORD PTR _this$[esp+8]

; 110  :   const size_type __old_size = size();

	mov	ecx, DWORD PTR [ebp+4]
	sub	ecx, DWORD PTR [ebp]
	mov	eax, -1307163959			; b21642c9H
	imul	ecx
	add	edx, ecx
	sar	edx, 6
	mov	eax, edx
	push	esi
	shr	eax, 31					; 0000001fH
	push	edi
	add	eax, edx

; 111  :   size_type __len = __old_size + (max)(__old_size, __fill_len);

	lea	ecx, DWORD PTR ___fill_len$[esp+16]
	push	ecx
	lea	edx, DWORD PTR ___old_size$[esp+20]
	push	edx
	mov	DWORD PTR ___old_size$[esp+24], eax
	call	??$max@I@stlp_std@@YAABIABI0@Z		; stlp_std::max<unsigned int>
	mov	ebx, DWORD PTR [eax]
	add	ebx, DWORD PTR ___old_size$[esp+24]

; 112  : 
; 113  :   pointer __new_start = this->_M_end_of_storage.allocate(__len, __len);

	mov	ecx, DWORD PTR __imp_?Memory@@3VxrMemory@@A
	imul	ebx, 92					; 0000005cH
	add	esp, 8
	push	ebx
	call	DWORD PTR __imp_?mem_alloc@xrMemory@@QAEPAXI@Z

; 114  :   pointer __new_finish = __STATIC_CAST(pointer, _STLP_PRIV __copy_trivial(this->_M_start, __pos, __new_start));

	mov	esi, DWORD PTR ___pos$[esp+16]
	mov	ecx, eax
	mov	eax, DWORD PTR [ebp]
	sub	esi, eax
	mov	DWORD PTR ___new_start$[esp+20], ecx
	je	SHORT $LN22@M_insert_o@15
	push	esi
	push	eax
	push	ecx
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, esi
	jmp	SHORT $LN23@M_insert_o@15
$LN22@M_insert_o@15:
	mov	eax, ecx
$LN23@M_insert_o@15:

; 115  :   // handle insertion
; 116  :   __new_finish = _STLP_PRIV __fill_n(__new_finish, __fill_len, __x);

	mov	edx, DWORD PTR ___fill_len$[esp+16]
	test	edx, edx
	jbe	SHORT $LN24@M_insert_o@15
	npad	7
$LL26@M_insert_o@15:
	mov	esi, DWORD PTR ___x$[esp+16]
	mov	edi, eax
	sub	edx, 1
	mov	ecx, 23					; 00000017H
	add	eax, 92					; 0000005cH
	test	edx, edx
	rep movsd
	ja	SHORT $LL26@M_insert_o@15
$LN24@M_insert_o@15:

; 117  :   if (!__atend)
; 118  :     __new_finish = __STATIC_CAST(pointer, _STLP_PRIV __copy_trivial(__pos, this->_M_finish, __new_finish)); // copy remainder

	mov	esi, DWORD PTR [ebp+4]
	mov	ecx, DWORD PTR ___pos$[esp+16]
	sub	esi, ecx
	mov	edi, eax
	je	SHORT $LN31@M_insert_o@15
	push	esi
	push	ecx
	push	eax
	call	DWORD PTR __imp__memmove
	mov	edi, eax
	add	esp, 12					; 0000000cH
	add	edi, esi
$LN31@M_insert_o@15:

; 119  :   _M_clear();

	mov	eax, DWORD PTR [ebp]
	test	eax, eax
	je	SHORT $LN63@M_insert_o@15
	mov	ecx, DWORD PTR __imp_?Memory@@3VxrMemory@@A
	push	eax
	call	DWORD PTR __imp_?mem_free@xrMemory@@QAEXPAX@Z
$LN63@M_insert_o@15:

; 120  :   _M_set(__new_start, __new_finish, __new_start + __len);

	mov	eax, DWORD PTR ___new_start$[esp+20]
	mov	DWORD PTR [ebp+4], edi

; 121  : }

	pop	edi
	add	ebx, eax
	pop	esi
	mov	DWORD PTR [ebp+8], ebx
	mov	DWORD PTR [ebp], eax
	pop	ebp
	pop	ebx
	pop	ecx
	ret	16					; 00000010H
?_M_insert_overflow@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@ABU45@ABU__true_type@3@I_N@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_insert_overflow
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?_M_fill_insert@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@@Z
_TEXT	SEGMENT
$T384732 = 8						; size = 1
___pos$ = 8						; size = 4
?_M_fill_insert@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert, COMDAT
; _this$ = ecx
; ___n$ = edi
; ___x$ = ebx

; 168  :   if (__n != 0) {

	test	edi, edi
	push	ebp
	mov	ebp, DWORD PTR ___pos$[esp]
	je	SHORT $LN1@M_fill_ins@15
	push	esi

; 169  :     if (size_type(this->_M_end_of_storage._M_data - this->_M_finish) >= __n) {

	mov	esi, DWORD PTR [ecx+8]
	sub	esi, DWORD PTR [ecx+4]
	mov	eax, -1307163959			; b21642c9H
	imul	esi
	add	edx, esi
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	add	eax, edx
	cmp	eax, edi
	pop	esi
	jb	SHORT $LN2@M_fill_ins@15

; 170  :       _M_fill_insert_aux(__pos, __n, __x, _Movable());

	lea	edx, DWORD PTR $T384732[esp]
	push	edx
	push	ebx
	push	edi
	push	ebp
	call	?_M_fill_insert_aux@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@ABU__false_type@3@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert_aux
	pop	ebp

; 173  :   }
; 174  : }

	ret	4
$LN2@M_fill_ins@15:

; 171  :     } else
; 172  :       _M_insert_overflow(__pos, __x, _TrivialCopy(), __n);

	push	edi
	push	ebx
	push	ebp
	push	ecx
	call	?_M_insert_overflow@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@ABU45@ABU__true_type@3@I_N@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_insert_overflow
$LN1@M_fill_ins@15:
	pop	ebp

; 173  :   }
; 174  : }

	ret	4
?_M_fill_insert@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\_vector.h
_TEXT	ENDS
;	COMDAT ?insert@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXPAUParticle@CEffect_Rain@@IABU45@@Z
_TEXT	SEGMENT
$T384745 = 8						; size = 1
___pos$ = 8						; size = 4
?insert@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXPAUParticle@CEffect_Rain@@IABU45@@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::insert, COMDAT
; _this$ = ecx
; ___n$ = edi
; ___x$ = ebx

; 529  :   { _M_fill_insert(__pos, __n, __x); }

	test	edi, edi
	push	ebp
	mov	ebp, DWORD PTR ___pos$[esp]
	je	SHORT $LN3@insert@7
	push	esi
	mov	esi, DWORD PTR [ecx+8]
	sub	esi, DWORD PTR [ecx+4]
	mov	eax, -1307163959			; b21642c9H
	imul	esi
	add	edx, esi
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	add	eax, edx
	cmp	eax, edi
	pop	esi
	jb	SHORT $LN4@insert@7
	lea	edx, DWORD PTR $T384745[esp]
	push	edx
	push	ebx
	push	edi
	push	ebp
	call	?_M_fill_insert_aux@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@ABU__false_type@3@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert_aux
	pop	ebp
	ret	4
$LN4@insert@7:
	push	edi
	push	ebx
	push	ebp
	push	ecx
	call	?_M_insert_overflow@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@ABU45@ABU__true_type@3@I_N@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_insert_overflow
$LN3@insert@7:
	pop	ebp
	ret	4
?insert@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXPAUParticle@CEffect_Rain@@IABU45@@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::insert
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?resize@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z
_TEXT	SEGMENT
$T384833 = 8						; size = 1
___x$ = 8						; size = 4
?resize@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z PROC ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::resize, COMDAT
; _this$ = edi

; 596  :   void resize(size_type __new_size, const _Tp& __x = _STLP_DEFAULT_CONSTRUCTED(_Tp)) {

	push	ebx

; 597  : #else
; 598  :   void resize(size_type __new_size, const _Tp& __x) {
; 599  : #endif /*_STLP_DONT_SUP_DFLT_PARAM*/
; 600  :     if (__new_size < size())

	mov	ebx, DWORD PTR [edi]
	push	ebp
	mov	ebp, DWORD PTR ___x$[esp+4]
	push	esi
	mov	esi, DWORD PTR [edi+4]
	mov	ecx, esi
	sub	ecx, ebx
	mov	eax, -1307163959			; b21642c9H
	imul	ecx
	add	edx, ecx
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	add	eax, edx
	cmp	eax, 1000				; 000003e8H
	jbe	SHORT $LN2@resize@5

; 601  :       erase(begin() + __new_size, end());

	lea	eax, DWORD PTR [ebx+92000]
	cmp	eax, esi
	je	SHORT $LN28@resize@5
	mov	ebx, esi
	sub	ebx, esi
	je	SHORT $LN20@resize@5
	push	ebx
	push	esi
	push	eax
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, ebx
$LN20@resize@5:
	pop	esi
	pop	ebp
	mov	DWORD PTR [edi+4], eax
	pop	ebx

; 604  :   }

	ret	4
$LN2@resize@5:

; 602  :     else
; 603  :       insert(end(), __new_size - size(), __x);

	mov	ebx, 1000				; 000003e8H
	sub	ebx, eax
	je	SHORT $LN28@resize@5
	mov	ecx, DWORD PTR [edi+8]
	sub	ecx, esi
	mov	eax, -1307163959			; b21642c9H
	imul	ecx
	add	edx, ecx
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	add	eax, edx
	cmp	eax, ebx
	jb	SHORT $LN29@resize@5
	lea	ecx, DWORD PTR $T384833[esp+8]
	push	ecx
	push	ebp
	push	ebx
	push	esi
	mov	ecx, edi
	call	?_M_fill_insert_aux@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@IABU45@ABU__false_type@3@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_fill_insert_aux
	pop	esi
	pop	ebp
	pop	ebx

; 604  :   }

	ret	4

; 602  :     else
; 603  :       insert(end(), __new_size - size(), __x);

$LN29@resize@5:
	push	ebx
	push	ebp
	push	esi
	push	edi
	call	?_M_insert_overflow@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@AAEXPAUParticle@CEffect_Rain@@ABU45@ABU__true_type@3@I_N@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::_M_insert_overflow
$LN28@resize@5:
	pop	esi
	pop	ebp
	pop	ebx

; 604  :   }

	ret	4
?resize@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z ENDP ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::resize
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\sdk\include\stlport\stl\pointers\_vector.h
_TEXT	ENDS
;	COMDAT ?resize@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z
_TEXT	SEGMENT
?resize@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z PROC ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::resize, COMDAT
; _this$ = edi
; ___x$ = eax

; 217  :   { _M_impl.resize(__new_size, cast_traits::to_storage_type_cref(__x)); }

	push	eax
	call	?resize@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::resize
	ret	0
?resize@?$vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z ENDP ; stlp_std::vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::resize
_TEXT	ENDS
PUBLIC	?p_create@CEffect_Rain@@AAEXXZ			; CEffect_Rain::p_create
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrengine\rain.cpp
;	COMDAT ?p_create@CEffect_Rain@@AAEXXZ
_TEXT	SEGMENT
_this$ = -96						; size = 4
$T384846 = -92						; size = 92
?p_create@CEffect_Rain@@AAEXXZ PROC			; CEffect_Rain::p_create, COMDAT
; _this$ = ecx

; 412  : {

	sub	esp, 96					; 00000060H
	push	ebx
	push	esi
	push	edi

; 413  : 	// pool
; 414  : 	particle_pool.resize	(max_particles);

	push	92					; 0000005cH
	lea	eax, DWORD PTR $T384846[esp+112]
	mov	ebx, ecx
	push	0
	push	eax
	mov	DWORD PTR _this$[esp+120], ebx
	call	_memset
	add	esp, 12					; 0000000cH
	lea	ecx, DWORD PTR $T384846[esp+108]
	lea	edi, DWORD PTR [ebx+20]
	push	ecx
	call	?resize@?$_Impl_vector@UParticle@CEffect_Rain@@V?$xalloc@UParticle@CEffect_Rain@@@@@priv@stlp_std@@QAEXIABUParticle@CEffect_Rain@@@Z ; stlp_std::priv::_Impl_vector<CEffect_Rain::Particle,xalloc<CEffect_Rain::Particle> >::resize

; 415  : 	for (u32 it=0; it<particle_pool.size(); it++)

	mov	ecx, DWORD PTR [edi+4]
	sub	ecx, DWORD PTR [edi]
	mov	eax, -1307163959			; b21642c9H
	imul	ecx
	add	edx, ecx
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	xor	esi, esi
	add	eax, edx
	je	SHORT $LN1@p_create
	push	ebp
$LL3@p_create:

; 416  : 	{
; 417  : 		Particle&	P	= particle_pool[it];

	mov	ecx, DWORD PTR [edi]
	mov	ebp, esi
	imul	ebp, 92					; 0000005cH

; 418  : 		P.prev			= it?(&particle_pool[it-1]):0;

	test	esi, esi
	lea	ebx, DWORD PTR [ecx+ebp]
	je	SHORT $LN6@p_create
	lea	eax, DWORD PTR [ebx-92]
	jmp	SHORT $LN7@p_create
$LN6@p_create:
	xor	eax, eax
$LN7@p_create:
	mov	DWORD PTR [ebx+4], eax

; 419  : 		P.next			= (it<(particle_pool.size()-1))?(&particle_pool[it+1]):0;

	mov	ecx, DWORD PTR [edi+4]
	sub	ecx, DWORD PTR [edi]
	mov	eax, -1307163959			; b21642c9H
	imul	ecx
	add	edx, ecx
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	lea	ecx, DWORD PTR [edx+eax-1]
	cmp	esi, ecx
	jae	SHORT $LN8@p_create
	mov	edx, DWORD PTR [edi]
	lea	eax, DWORD PTR [edx+ebp+92]
	jmp	SHORT $LN9@p_create
$LN8@p_create:
	xor	eax, eax
$LN9@p_create:
	mov	DWORD PTR [ebx], eax
	mov	ecx, DWORD PTR [edi+4]
	sub	ecx, DWORD PTR [edi]
	mov	eax, -1307163959			; b21642c9H
	imul	ecx
	add	edx, ecx
	sar	edx, 6
	mov	eax, edx
	shr	eax, 31					; 0000001fH
	add	esi, 1
	add	eax, edx
	cmp	esi, eax
	jb	SHORT $LL3@p_create
	mov	ebx, DWORD PTR _this$[esp+112]
	pop	ebp
$LN1@p_create:

; 420  : 	}
; 421  : 	
; 422  : 	// active and idle lists
; 423  : 	particle_active	= 0;
; 424  : 	particle_idle	= &particle_pool.front();

	mov	ecx, DWORD PTR [edi]
	pop	edi
	pop	esi
	mov	DWORD PTR [ebx+32], 0
	mov	DWORD PTR [ebx+36], ecx
	pop	ebx

; 425  : }

	add	esp, 96					; 00000060H
	ret	0
?p_create@CEffect_Rain@@AAEXXZ ENDP			; CEffect_Rain::p_create
_TEXT	ENDS
PUBLIC	?OnFrame@CEffect_Rain@@QAEXXZ			; CEffect_Rain::OnFrame
; Function compile flags: /Ogtpy
;	COMDAT ?OnFrame@CEffect_Rain@@QAEXXZ
_TEXT	SEGMENT
$T385247 = -16						; size = 4
_factor$ = -16						; size = 4
$T384997 = -12						; size = 12
?OnFrame@CEffect_Rain@@QAEXXZ PROC			; CEffect_Rain::OnFrame, COMDAT
; _this$ = ecx

; 125  : #ifndef _EDITOR
; 126  : 	if (!g_pGameLevel)			return;

	mov	eax, DWORD PTR ?g_pGameLevel@@3PAVIGame_Level@@A ; g_pGameLevel
	sub	esp, 16					; 00000010H
	test	eax, eax
	push	edi
	mov	edi, ecx
	je	$LN100@OnFrame@2

; 127  : #endif
; 128  : 
; 129  : #ifdef DEDICATED_SERVER
; 130  : 	return;
; 131  : #endif
; 132  : 
; 133  : 	// Parse states
; 134  : 	float	factor				= g_pGamePersistent->Environment().CurrentEnv->rain_density;

	mov	ecx, DWORD PTR ?g_pGamePersistent@@3PAVIGame_Persistent@@A ; g_pGamePersistent
	mov	edx, DWORD PTR [ecx+1128]
	mov	ecx, DWORD PTR [edx+120]

; 135  : 	static float hemi_factor	= 0.f;
; 136  : #ifndef _EDITOR
; 137  : 	CObject* E 					= g_pGameLevel->CurrentViewEntity();

	mov	eax, DWORD PTR [eax+36]

; 138  : 	if (E&&E->renderable_ROS())

	test	eax, eax
	movss	xmm0, DWORD PTR [ecx+80]
	push	esi
	movss	DWORD PTR _factor$[esp+24], xmm0
	je	$LN122@OnFrame@2
	cmp	DWORD PTR [eax+148], 0
	lea	esi, DWORD PTR [eax+76]
	jne	SHORT $LN19@OnFrame@2
	cmp	DWORD PTR [esi+76], 0
	je	SHORT $LN16@OnFrame@2
	mov	edx, DWORD PTR __imp_?Render@@3PAVIRender_interface@@A
	mov	ecx, DWORD PTR [edx]
	mov	eax, DWORD PTR [ecx]
	mov	edx, DWORD PTR [eax+116]
	push	esi
	call	edx
	movss	xmm0, DWORD PTR _factor$[esp+24]
	mov	DWORD PTR [esi+72], eax
$LN16@OnFrame@2:
	cmp	DWORD PTR [esi+72], 0
	je	$LN122@OnFrame@2

; 139  : 	{
; 140  : //		hemi_factor				= 1.f-2.0f*(0.3f-_min(_min(1.f,E->renderable_ROS()->get_luminocity_hemi()),0.3f));
; 141  : 		float* hemi_cube		= E->renderable_ROS()->get_luminocity_hemi_cube();

$LN19@OnFrame@2:
	mov	ecx, DWORD PTR [esi+72]
	mov	edx, DWORD PTR [ecx]
	mov	eax, DWORD PTR [edx+12]
	call	eax

; 142  : 		float hemi_val			= _max(hemi_cube[0],hemi_cube[1]);

	movss	xmm0, DWORD PTR [eax]
	movss	xmm2, DWORD PTR [eax+4]
	comiss	xmm0, xmm2
	jbe	SHORT $LN24@OnFrame@2
	movaps	xmm2, xmm0
$LN24@OnFrame@2:

; 143  : 		hemi_val				= _max(hemi_val, hemi_cube[2]);

	movss	xmm0, DWORD PTR [eax+8]
	comiss	xmm2, xmm0
	ja	SHORT $LN29@OnFrame@2
	movaps	xmm2, xmm0
$LN29@OnFrame@2:

; 144  : 		hemi_val				= _max(hemi_val, hemi_cube[3]);

	movss	xmm0, DWORD PTR [eax+12]
	comiss	xmm2, xmm0
	ja	SHORT $LN33@OnFrame@2
	movaps	xmm2, xmm0
$LN33@OnFrame@2:

; 145  : 		hemi_val				= _max(hemi_val, hemi_cube[5]);

	movss	xmm0, DWORD PTR [eax+20]
	comiss	xmm2, xmm0
	ja	SHORT $LN37@OnFrame@2
	movaps	xmm2, xmm0
$LN37@OnFrame@2:

; 146  : 		
; 147  : //		float f					= 0.9f*hemi_factor + 0.1f*hemi_val;
; 148  : 		float f					= hemi_val;
; 149  : 		float t					= Device.fTimeDelta;

	movss	xmm0, DWORD PTR ?Device@@3VCRenderDevice@@A+28

; 150  : 		clamp					(t, 0.001f, 1.0f);

	movss	xmm3, DWORD PTR _EPS_L
	comiss	xmm3, xmm0
	movss	xmm1, DWORD PTR __real@3f800000
	jbe	SHORT $LN40@OnFrame@2
	movaps	xmm0, xmm3
	jmp	SHORT $LN38@OnFrame@2
$LN40@OnFrame@2:
	comiss	xmm0, xmm1
	jbe	SHORT $LN38@OnFrame@2
	movaps	xmm0, xmm1
$LN38@OnFrame@2:

; 151  : 		hemi_factor				= hemi_factor*(1.0f-t) + f*t;

	subss	xmm1, xmm0
	mulss	xmm1, DWORD PTR ?hemi_factor@?3??OnFrame@CEffect_Rain@@QAEXXZ@4MA
	mulss	xmm0, xmm2
	addss	xmm1, xmm0
	movss	xmm0, DWORD PTR _factor$[esp+24]
	movss	DWORD PTR ?hemi_factor@?3??OnFrame@CEffect_Rain@@QAEXXZ@4MA, xmm1
	jmp	SHORT $LN8@OnFrame@2
$LN122@OnFrame@2:
	movss	xmm3, DWORD PTR _EPS_L
$LN8@OnFrame@2:

; 152  : 	}
; 153  : #endif
; 154  : 
; 155  : 	switch (state)

	mov	eax, DWORD PTR [edi+16]
	sub	eax, 0
	je	SHORT $LN5@OnFrame@2
	sub	eax, 1
	jne	$LN6@OnFrame@2

; 163  : 	break;
; 164  : 	case stWorking:
; 165  : 		if (factor<EPS_L){

	comiss	xmm3, xmm0
	jbe	$LN6@OnFrame@2

; 166  : 			state				= stIdle;

	mov	DWORD PTR [edi+16], eax

; 167  : 			snd_Ambient.stop	();

	mov	edi, DWORD PTR [edi+40]
	mov	ecx, edi
	neg	ecx
	sbb	ecx, ecx
	test	ecx, OFFSET ?_get@?$resptr_base@Vref_sound_data@@@@QBEPAVref_sound_data@@XZ ; resptr_base<ref_sound_data>::_get
	je	$LN123@OnFrame@2
	mov	ecx, DWORD PTR [edi+12]
	test	ecx, ecx
	je	$LN123@OnFrame@2
	mov	edx, DWORD PTR [ecx]
	push	eax
	mov	eax, DWORD PTR [edx+32]
	call	eax
	pop	esi
	pop	edi

; 180  : 	}
; 181  : }

	add	esp, 16					; 00000010H
	ret	0
$LN5@OnFrame@2:

; 156  : 	{
; 157  : 	case stIdle:		
; 158  : 		if (factor<EPS_L)		return;

	comiss	xmm3, xmm0
	ja	$LN123@OnFrame@2

; 159  : 		state					= stWorking;
; 160  : 		snd_Ambient.play		(0,sm_Looped);

	mov	ecx, DWORD PTR __imp_?Sound@@3PAVCSound_manager_interface@@A
	fldz
	mov	DWORD PTR [edi+16], 1
	mov	ecx, DWORD PTR [ecx]
	mov	edx, DWORD PTR [ecx]
	mov	eax, DWORD PTR [edx+52]
	push	ecx
	fstp	DWORD PTR [esp]
	push	1
	push	0
	lea	esi, DWORD PTR [edi+40]
	push	esi
	call	eax

; 161  : 		snd_Ambient.set_position(Fvector().set(0,0,0));

	xorps	xmm0, xmm0
	xor	eax, eax
	mov	DWORD PTR $T384997[esp+24], eax
	mov	DWORD PTR $T384997[esp+28], eax
	mov	DWORD PTR $T384997[esp+32], eax
	mov	eax, DWORD PTR [esi]
	mov	ecx, eax
	neg	ecx
	sbb	ecx, ecx
	test	ecx, OFFSET ?_get@?$resptr_base@Vref_sound_data@@@@QBEPAVref_sound_data@@XZ ; resptr_base<ref_sound_data>::_get
	movss	DWORD PTR $T384997[esp+24], xmm0
	movss	DWORD PTR $T384997[esp+28], xmm0
	movss	DWORD PTR $T384997[esp+32], xmm0
	je	SHORT $LN60@OnFrame@2
	mov	eax, DWORD PTR [eax+12]
	jmp	SHORT $LN61@OnFrame@2
$LN60@OnFrame@2:
	xor	eax, eax
$LN61@OnFrame@2:
	mov	edx, DWORD PTR [eax]
	mov	edx, DWORD PTR [edx+12]
	lea	ecx, DWORD PTR $T384997[esp+24]
	push	ecx
	mov	ecx, eax
	call	edx

; 162  : 		snd_Ambient.set_range	(source_offset,source_offset*2.f);

	fld	DWORD PTR _drop_speed_max
	sub	esp, 8
	fstp	DWORD PTR [esp+4]
	mov	eax, esi
	fld	DWORD PTR _source_offset
	fstp	DWORD PTR [esp]
	call	?set_range@ref_sound@@QAEXMM@Z		; ref_sound::set_range
	movss	xmm0, DWORD PTR _factor$[esp+24]
$LN6@OnFrame@2:

; 168  : 			return;
; 169  : 		}
; 170  : 		break;
; 171  : 	}
; 172  : 
; 173  : 	// ambient sound
; 174  : 	if (snd_Ambient._feedback())

	mov	eax, DWORD PTR [edi+40]
	mov	ecx, eax
	neg	ecx
	sbb	ecx, ecx
	test	ecx, OFFSET ?_get@?$resptr_base@Vref_sound_data@@@@QBEPAVref_sound_data@@XZ ; resptr_base<ref_sound_data>::_get
	je	SHORT $LN123@OnFrame@2
	cmp	DWORD PTR [eax+12], 0
	je	SHORT $LN123@OnFrame@2

; 175  : 	{
; 176  : //		Fvector					sndP;
; 177  : //		sndP.mad				(Device.vCameraPosition,Fvector().set(0,1,0),source_offset);
; 178  : //		snd_Ambient.set_position(sndP);
; 179  : 		snd_Ambient.set_volume	(_max(0.1f,factor) * hemi_factor );

	movss	xmm1, DWORD PTR _psShedulerReaction
	comiss	xmm1, xmm0
	jbe	SHORT $LN98@OnFrame@2
	movaps	xmm0, xmm1
$LN98@OnFrame@2:
	mulss	xmm0, DWORD PTR ?hemi_factor@?3??OnFrame@CEffect_Rain@@QAEXXZ@4MA
	mov	edi, eax
	mov	edx, eax
	neg	edx
	sbb	edx, edx
	test	edx, OFFSET ?_get@?$resptr_base@Vref_sound_data@@@@QBEPAVref_sound_data@@XZ ; resptr_base<ref_sound_data>::_get
	movss	DWORD PTR $T385247[esp+24], xmm0
	je	SHORT $LN123@OnFrame@2
	mov	ecx, DWORD PTR [edi+12]
	test	ecx, ecx
	je	SHORT $LN123@OnFrame@2
	mov	eax, DWORD PTR [ecx]
	fld	DWORD PTR $T385247[esp+24]
	mov	edx, DWORD PTR [eax+24]
	push	ecx
	fstp	DWORD PTR [esp]
	call	edx
$LN123@OnFrame@2:
	pop	esi
$LN100@OnFrame@2:
	pop	edi

; 180  : 	}
; 181  : }

	add	esp, 16					; 00000010H
	ret	0
?OnFrame@CEffect_Rain@@QAEXXZ ENDP			; CEffect_Rain::OnFrame
_TEXT	ENDS
PUBLIC	__real@3aa00140
PUBLIC	?Born@CEffect_Rain@@AAEXAAUItem@1@M@Z		; CEffect_Rain::Born
;	COMDAT __real@3aa00140
; File d:\clearsky\sources\engine\xrengine\igame_level.h
CONST	SEGMENT
__real@3aa00140 DD 03aa00140r			; 0.00122074
; Function compile flags: /Ogtpy
; File d:\clearsky\sources\engine\xrengine\rain.cpp
CONST	ENDS
;	COMDAT ?Born@CEffect_Rain@@AAEXAAUItem@1@M@Z
_TEXT	SEGMENT
$T385310 = -24						; size = 4
_k$ = -24						; size = 4
__cp$385307 = -20					; size = 4
_angle$ = -20						; size = 4
tv364 = -16						; size = 4
$T385368 = -16						; size = 4
_pitch$ = -16						; size = 4
_RQ$385405 = -12					; size = 12
_axis$ = -12						; size = 12
$T385369 = 8						; size = 4
_dest$ = 8						; size = 4
_height$ = 12						; size = 4
_dist$ = 12						; size = 4
_radius$ = 12						; size = 4
?Born@CEffect_Rain@@AAEXAAUItem@1@M@Z PROC		; CEffect_Rain::Born, COMDAT
; _this$ = ecx

; 72   : {

	sub	esp, 24					; 00000018H

; 73   : 	Fvector		axis;	
; 74   :     axis.set			(0,-1,0);
; 75   : 	float gust			= g_pGamePersistent->Environment().wind_strength_factor/10.f;

	mov	eax, DWORD PTR ?g_pGamePersistent@@3PAVIGame_Persistent@@A ; g_pGamePersistent

; 76   : 	float k				= g_pGamePersistent->Environment().CurrentEnv->wind_velocity*gust/drop_max_wind_vel;
; 77   : 	clamp				(k,0.f,1.f);

	xorps	xmm1, xmm1
	push	ebx
	push	esi
	push	edi
	mov	edi, ecx
	mov	ecx, DWORD PTR [eax+1128]
	movss	xmm0, DWORD PTR [ecx+40]
	mulss	xmm0, DWORD PTR _psShedulerReaction
	mov	ecx, DWORD PTR [ecx+120]
	mulss	xmm0, DWORD PTR [ecx+104]
	mulss	xmm0, DWORD PTR _LDIST
	comiss	xmm1, xmm0
	movss	DWORD PTR _k$[esp+36], xmm0
	ja	SHORT $LN77@Born
	movss	xmm1, DWORD PTR __real@3f800000
	comiss	xmm0, xmm1
	jbe	SHORT $LN9@Born
$LN77@Born:
	movss	DWORD PTR _k$[esp+36], xmm1
$LN9@Born:

; 78   : 	float	pitch		= drop_max_angle*k-PI_DIV_2;

	fld	DWORD PTR _drop_max_angle

; 79   :     axis.setHP			(g_pGamePersistent->Environment().CurrentEnv->wind_direction,pitch);

	mov	edx, DWORD PTR [eax+1128]
	fmul	DWORD PTR _k$[esp+36]
	mov	eax, DWORD PTR [edx+120]
	push	ecx
	fsub	DWORD PTR _PI_DIV_2
	fst	DWORD PTR _pitch$[esp+40]
	fld	DWORD PTR [eax+108]
	fstp	DWORD PTR $T385310[esp+40]
	fstp	DWORD PTR [esp]
	call	_cosf
	fstp	DWORD PTR __cp$385307[esp+40]
	fld	DWORD PTR $T385310[esp+40]
	fstp	DWORD PTR [esp]
	call	_sinf
	fmul	DWORD PTR __cp$385307[esp+40]
	fchs
	fstp	DWORD PTR _axis$[esp+40]
	fld	DWORD PTR _pitch$[esp+40]
	fstp	DWORD PTR [esp]
	call	_sinf
	fstp	DWORD PTR _axis$[esp+44]
	fld	DWORD PTR $T385310[esp+40]
	fstp	DWORD PTR [esp]
	call	_cosf
	fmul	DWORD PTR __cp$385307[esp+40]

; 80   :     
; 81   : 	Fvector&	view	= Device.vCameraPosition;
; 82   : 	float		angle	= ::Random.randF	(0,PI_MUL_2);

	mov	eax, DWORD PTR __imp_?Random@@3VCRandom@@A
	add	esp, 4
	fstp	DWORD PTR _axis$[esp+44]
	call	?randI@CRandom@@QAEHXZ			; CRandom::randI
	mov	DWORD PTR tv364[esp+36], eax
	fild	DWORD PTR tv364[esp+36]

; 83   : 	float		dist	= ::Random.randF	(); dist = _sqrt(dist)*radius; 

	mov	eax, DWORD PTR __imp_?Random@@3VCRandom@@A
	fmul	DWORD PTR __real@3949116d
	fstp	DWORD PTR _angle$[esp+36]
	call	?randI@CRandom@@QAEHXZ			; CRandom::randI
	cvtsi2ss xmm0, eax
	mulss	xmm0, DWORD PTR __real@38000100
	push	ecx
	movss	DWORD PTR [esp], xmm0
	call	_sqrtf
	fmul	DWORD PTR _radius$[esp+36]

; 84   : 	float		x		= dist*_cos		(angle);
; 85   : 	float		z		= dist*_sin		(angle);
; 86   : 	dest.D.random_dir	(axis,deg2rad(drop_angle));

	mov	esi, DWORD PTR _dest$[esp+36]
	mov	eax, DWORD PTR __imp_?Random@@3VCRandom@@A
	fstp	DWORD PTR _dist$[esp+36]
	lea	ecx, DWORD PTR _axis$[esp+40]
	fld	DWORD PTR __real@3d567750
	lea	ebx, DWORD PTR [esi+24]
	fstp	DWORD PTR [esp]
	push	ecx
	call	?random_dir@?$_vector3@M@@QAEAAU1@ABU1@MAAVCRandom@@@Z ; _vector3<float>::random_dir
	fld	DWORD PTR _angle$[esp+36]

; 87   : 	dest.P.set			(x+view.x-dest.D.x*source_offset,source_offset+view.y,z+view.z-dest.D.z*source_offset);

	movss	xmm0, DWORD PTR ?Device@@3VCRenderDevice@@A+52
	addss	xmm0, DWORD PTR _source_offset
	push	ecx
	fstp	DWORD PTR [esp]
	movss	DWORD PTR $T385369[esp+36], xmm0
	call	_sinf
	fmul	DWORD PTR _dist$[esp+36]
	fadd	DWORD PTR ?Device@@3VCRenderDevice@@A+56
	fld	DWORD PTR [esi+32]
	fmul	DWORD PTR _source_offset
	fsubp	ST(1), ST(0)
	fstp	DWORD PTR $T385368[esp+40]
	fld	DWORD PTR _angle$[esp+40]
	fstp	DWORD PTR [esp]
	call	_cosf
	fmul	DWORD PTR _dist$[esp+36]
	movss	xmm0, DWORD PTR $T385369[esp+36]
	add	esp, 4
	fadd	DWORD PTR ?Device@@3VCRenderDevice@@A+48
	movss	DWORD PTR [esi+4], xmm0
	fld	DWORD PTR [ebx]
	fmul	DWORD PTR _source_offset
	fsubp	ST(1), ST(0)
	fstp	DWORD PTR [esi]
	fld	DWORD PTR $T385368[esp+36]
	fstp	DWORD PTR [esi+8]

; 88   : //	dest.P.set			(x+view.x,height+view.y,z+view.z);
; 89   : 	dest.fSpeed			= ::Random.randF	(drop_speed_min,drop_speed_max);

	mov	eax, DWORD PTR __imp_?Random@@3VCRandom@@A
	call	?randI@CRandom@@QAEHXZ			; CRandom::randI
	cvtsi2ss xmm0, eax
	mulss	xmm0, DWORD PTR __real@3aa00140

; 90   : 
; 91   : 	float height		= max_distance;
; 92   : 	RenewItem			(dest,height,RayPick(dest.P,dest.D,height,collide::rqtBoth));

	fld	DWORD PTR _max_distance
	addss	xmm0, DWORD PTR _source_offset
	movss	DWORD PTR [esi+36], xmm0
	mov	eax, DWORD PTR ?g_pGameLevel@@3PAVIGame_Level@@A ; g_pGameLevel
	mov	ecx, DWORD PTR [eax+36]
	movss	xmm0, DWORD PTR _max_distance
	push	ecx
	lea	edx, DWORD PTR _RQ$385405[esp+40]
	push	edx
	push	3
	push	ecx
	fstp	DWORD PTR [esp]
	push	ebx
	push	esi
	lea	ecx, DWORD PTR [eax+262292]
	movss	DWORD PTR _height$[esp+56], xmm0
	call	DWORD PTR __imp_?RayPick@CObjectSpace@@QAEHABU?$_vector3@M@@0MW4rq_target@collide@@AAUrq_result@4@PAVCObject@@@Z
	test	eax, eax
	je	SHORT $LN72@Born
	movss	xmm0, DWORD PTR _RQ$385405[esp+40]
	movss	DWORD PTR _height$[esp+32], xmm0
$LN72@Born:
	fld	DWORD PTR _height$[esp+32]
	push	eax
	push	ecx
	fstp	DWORD PTR [esp]
	push	esi
	mov	ecx, edi
	call	?RenewItem@CEffect_Rain@@AAEXAAUItem@1@MH@Z ; CEffect_Rain::RenewItem
	pop	edi
	pop	esi
	pop	ebx

; 93   : }

	add	esp, 24					; 00000018H
	ret	8
?Born@CEffect_Rain@@AAEXAAUItem@1@M@Z ENDP		; CEffect_Rain::Born
_TEXT	ENDS
PUBLIC	??1CEffect_Rain@@QAE@XZ				; CEffect_Rain::~CEffect_Rain
; Function compile flags: /Ogtpy
;	COMDAT ??1CEffect_Rain@@QAE@XZ
_TEXT	SEGMENT
$T385640 = -1						; size = 1
??1CEffect_Rain@@QAE@XZ PROC				; CEffect_Rain::~CEffect_Rain, COMDAT
; _this$ = ecx

; 61   : {

	push	ecx

; 62   : 	snd_Ambient.destroy				();

	mov	eax, DWORD PTR __imp_?Sound@@3PAVCSound_manager_interface@@A
	push	ebp
	push	esi
	mov	esi, ecx
	mov	ecx, DWORD PTR [eax]
	mov	edx, DWORD PTR [ecx]
	mov	eax, DWORD PTR [edx+40]
	push	edi
	lea	edi, DWORD PTR [esi+40]
	push	edi
	call	eax

; 63   : 
; 64   : 	// Cleanup
; 65   : 	p_destroy						();

	mov	DWORD PTR [esi+32], 0
	mov	DWORD PTR [esi+36], 0
	mov	eax, DWORD PTR [esi+24]
	mov	ecx, DWORD PTR [esi+20]
	cmp	ecx, eax
	je	SHORT $LN25@CEffect_Ra
	mov	ebp, eax
	sub	ebp, eax
	je	SHORT $LN31@CEffect_Ra
	push	ebp
	push	eax
	push	ecx
	call	DWORD PTR __imp__memmove
	add	esp, 12					; 0000000cH
	add	eax, ebp
	jmp	SHORT $LN32@CEffect_Ra
$LN31@CEffect_Ra:
	mov	eax, ecx
$LN32@CEffect_Ra:
	mov	DWORD PTR [esi+24], eax
$LN25@CEffect_Ra:

; 66   : 	//	Moved to p_Render destructor
; 67   : 	//::Render->model_Delete			(DM_Drop);
; 68   : }

	mov	eax, DWORD PTR [edi]
	test	eax, eax
	je	SHORT $LN41@CEffect_Ra
	add	DWORD PTR [eax+4], -1
	mov	eax, DWORD PTR [edi]
	cmp	DWORD PTR [eax+4], 0
	jne	SHORT $LN41@CEffect_Ra
	test	eax, eax
	je	SHORT $LN41@CEffect_Ra
	push	edi
	lea	ecx, DWORD PTR $T385640[esp+20]
	mov	BYTE PTR $T385640[esp+20], 0
	call	??R?$xr_special_free@$00Vref_sound_data@@@@QAEXAAPAVref_sound_data@@@Z ; xr_special_free<1,ref_sound_data>::operator()
	mov	DWORD PTR [edi], 0
$LN41@CEffect_Ra:
	mov	eax, DWORD PTR [esi+20]
	test	eax, eax
	mov	edi, DWORD PTR __imp_?mem_free@xrMemory@@QAEXPAX@Z
	je	SHORT $LN83@CEffect_Ra
	mov	ecx, DWORD PTR __imp_?Memory@@3VxrMemory@@A
	push	eax
	call	edi
$LN83@CEffect_Ra:
	mov	eax, DWORD PTR [esi+4]
	test	eax, eax
	je	SHORT $LN123@CEffect_Ra
	mov	ecx, DWORD PTR __imp_?Memory@@3VxrMemory@@A
	push	eax
	call	edi
$LN123@CEffect_Ra:
	mov	ecx, DWORD PTR __imp_?RenderFactory@@3PAVIRenderFactory@@A
	mov	ecx, DWORD PTR [ecx]
	mov	edx, DWORD PTR [ecx]
	mov	eax, DWORD PTR [esi]
	mov	edx, DWORD PTR [edx+92]
	push	eax
	call	edx
	pop	edi
	mov	DWORD PTR [esi], 0
	pop	esi
	pop	ebp
	pop	ecx
	ret	0
??1CEffect_Rain@@QAE@XZ ENDP				; CEffect_Rain::~CEffect_Rain
_TEXT	ENDS
PUBLIC	??0CEffect_Rain@@QAE@XZ				; CEffect_Rain::CEffect_Rain
; Function compile flags: /Ogtpy
;	COMDAT ??0CEffect_Rain@@QAE@XZ
_TEXT	SEGMENT
??0CEffect_Rain@@QAE@XZ PROC				; CEffect_Rain::CEffect_Rain, COMDAT
; _this$ = ecx

; 40   : {

	mov	eax, DWORD PTR __imp_?RenderFactory@@3PAVIRenderFactory@@A
	push	esi
	mov	esi, ecx
	mov	ecx, DWORD PTR [eax]
	mov	edx, DWORD PTR [ecx]
	mov	eax, DWORD PTR [edx+88]
	push	edi
	call	eax

; 41   : 	state							= stIdle;
; 42   : 	
; 43   : 	snd_Ambient.create				("ambient\\rain",st_Effect,sg_Undefined);

	mov	ecx, DWORD PTR __imp_?Sound@@3PAVCSound_manager_interface@@A
	mov	DWORD PTR [esi], eax
	xor	eax, eax
	mov	DWORD PTR [esi+4], eax
	mov	DWORD PTR [esi+8], eax
	mov	DWORD PTR [esi+12], eax
	mov	DWORD PTR [esi+20], eax
	mov	DWORD PTR [esi+24], eax
	mov	DWORD PTR [esi+28], eax
	lea	edx, DWORD PTR [esi+40]
	mov	DWORD PTR [edx], eax
	push	eax
	mov	DWORD PTR [esi+16], eax
	mov	ecx, DWORD PTR [ecx]
	mov	edi, DWORD PTR [ecx]
	push	eax
	push	OFFSET ??_C@_0N@LMFHAIJK@ambient?2rain?$AA@
	push	edx
	mov	edx, DWORD PTR [edi+28]
	call	edx

; 44   : 
; 45   : 	//	Moced to p_Render constructor
; 46   : 	/*
; 47   : 	IReader*	F					= FS.r_open("$game_meshes$","dm\\rain.dm"); 
; 48   : 	VERIFY3							(F,"Can't open file.","dm\\rain.dm");
; 49   : 	DM_Drop							= ::Render->model_CreateDM		(F);
; 50   : 
; 51   : 	//
; 52   : 	SH_Rain.create					("effects\\rain","fx\\fx_rain");
; 53   : 	hGeom_Rain.create				(FVF::F_LIT, RCache.Vertex.Buffer(), RCache.QuadIB);
; 54   : 	hGeom_Drops.create				(D3DFVF_XYZ | D3DFVF_DIFFUSE | D3DFVF_TEX1, RCache.Vertex.Buffer(), RCache.Index.Buffer());
; 55   : 	*/
; 56   : 	p_create						();

	mov	ecx, esi
	call	?p_create@CEffect_Rain@@AAEXXZ		; CEffect_Rain::p_create
	pop	edi

; 57   : 	//FS.r_close						(F);
; 58   : }

	mov	eax, esi
	pop	esi
	ret	0
??0CEffect_Rain@@QAE@XZ ENDP				; CEffect_Rain::CEffect_Rain
_max_distance DD 042480000r			; 50
; Function compile flags: /Ogtpy
;	COMDAT ??__Esink_offset@@YAXXZ
text$yc	SEGMENT
??__Esink_offset@@YAXXZ PROC				; `dynamic initializer for 'sink_offset'', COMDAT

; 22   : static const float	sink_offset			= -(max_distance-source_offset);

	movss	xmm0, DWORD PTR _max_distance
	subss	xmm0, DWORD PTR _source_offset
	movss	xmm1, DWORD PTR __real@80000000
	subss	xmm1, xmm0
	movss	DWORD PTR _sink_offset, xmm1
	ret	0
??__Esink_offset@@YAXXZ ENDP				; `dynamic initializer for 'sink_offset''
_drop_max_angle DD 03e32b8c3r			; 0.174533
_sink_offset DD	01H DUP (?)
_sink_offset$initializer$ DD FLAT:??__Esink_offset@@YAXXZ
END
